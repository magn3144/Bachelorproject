(()=>{let e;var t,i,n,o,s,r,a,c,l,u,d,h,p,f,g,v,m,y,w,b,C,S,I,_,E,O,k,T,R,A,L,P,D,j,N,x,V,M,U,G,F,W,H,B,$,q,z,Q,Y,K,J,X,Z,ee,et,ei,en,eo,es,er,ea,ec,el,eu,ed,eh,ep,ef,eg,ev,em,ey,ew,eb,eC,eS,eI,e_,eE,eO,ek,eT,eR,eA,eL,eP,eD,ej,eN,ex,eV,eM,eU,eG,eF,eW,eH,eB,e$,eq,ez,eQ,eY,eK,eJ,eX,eZ,e0,e1,e2,e6,e3,e4,e5,e8,e9,e7,te,tt,ti,tn,to,ts,tr,ta,tc,tl,tu,td,th,tp,tf,tg,tv,tm,ty,tw,tb,tC,tS,tI,t_,tE,tO,tk="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function tT(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r}function tR(e,t){return function(i,n){t(i,n,e)}}function tA(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function tL(e,t,i,n){return new(i||(i=Promise))(function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}c((n=n.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;var tP={},tD=tP={};function tj(){throw Error("setTimeout has not been defined")}function tN(){throw Error("clearTimeout has not been defined")}function tx(e){if(t===setTimeout)return setTimeout(e,0);if((t===tj||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(i){try{return t.call(null,e,0)}catch(i){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:tj}catch(e){t=tj}try{i="function"==typeof clearTimeout?clearTimeout:tN}catch(e){i=tN}}();var tV=[],tM=!1,tU=-1;function tG(){tM&&n&&(tM=!1,n.length?tV=n.concat(tV):tU=-1,tV.length&&tF())}function tF(){if(!tM){var e=tx(tG);tM=!0;for(var t=tV.length;t;){for(n=tV,tV=[];++tU<t;)n&&n[tU].run();tU=-1,t=tV.length}n=null,tM=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===tN||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function tW(e,t){this.fun=e,this.array=t}function tH(){}tD.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];tV.push(new tW(e,t)),1!==tV.length||tM||tx(tF)},tW.prototype.run=function(){this.fun.apply(null,this.array)},tD.title="browser",tD.browser=!0,tD.env={},tD.argv=[],tD.version="",tD.versions={},tD.on=tH,tD.addListener=tH,tD.once=tH,tD.off=tH,tD.removeListener=tH,tD.removeAllListeners=tH,tD.emit=tH,tD.prependListener=tH,tD.prependOnceListener=tH,tD.listeners=function(e){return[]},tD.binding=function(e){throw Error("process.binding is not supported")},tD.cwd=function(){return"/"},tD.chdir=function(e){throw Error("process.chdir is not supported")},tD.umask=function(){return 0},function(e){!function(t){var i="object"==typeof tk?tk:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=o(e);function o(e,t){return function(i,n){"function"!=typeof e[i]&&Object.defineProperty(e,i,{configurable:!0,writable:!0,value:n}),t&&t(i,n)}}void 0===i.Reflect?i.Reflect=e:n=o(i.Reflect,n),t(n)}(function(e){var t=Object.prototype.hasOwnProperty,i="function"==typeof Symbol,n=i&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=i&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,r=({__proto__:[]})instanceof Array,a=!s&&!r,c={create:s?function(){return R(Object.create(null))}:r?function(){return R({__proto__:null})}:function(){return R({})},has:a?function(e,i){return t.call(e,i)}:function(e,t){return t in e},get:a?function(e,i){return t.call(e,i)?e[i]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),u="object"==typeof tP&&tP.env&&!1,d=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var e={},t=[],i=function(){function e(e,t,i){this._index=0,this._keys=e,this._values=t,this._selector=i}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var i=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:i,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var i=this._find(e,!0);return this._values[i]=t,this},t.prototype.delete=function(t){var i=this._find(t,!1);if(i>=0){for(var n=this._keys.length,o=i+1;o<n;o++)this._keys[o-1]=this._keys[o],this._values[o-1]=this._values[o];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new i(this._keys,this._values,n)},t.prototype.values=function(){return new i(this._keys,this._values,s)},t.prototype.entries=function(){return new i(this._keys,this._values,r)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function s(e,t){return t}function r(e,t){return[e,t]}}():Map,h=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function e(){this._map=new d}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}():Set,p=new(u||"function"!=typeof WeakMap?function(){var e=c.create(),i=n();return function(){function e(){this._key=n()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=n()},e}();function n(){var t;do t="@@WeakMap@@"+function(){var e="function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(16)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(16)):s(new Uint8Array(16),16):s(Array(16),16);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var t="",i=0;i<16;++i){var n=e[i];(4===i||6===i||8===i)&&(t+="-"),n<16&&(t+="0"),t+=n.toString(16).toLowerCase()}return t}();while(c.has(e,t))return e[t]=!0,t}function o(e,n){if(!t.call(e,i)){if(!n)return;Object.defineProperty(e,i,{value:c.create()})}return e[i]}function s(e,t){for(var i=0;i<t;++i)e[i]=255*Math.random()|0;return e}}():WeakMap);function f(e,t,i){var n=p.get(e);if(b(n)){if(!i)return;n=new d,p.set(e,n)}var o=n.get(t);if(b(o)){if(!i)return;o=new d,n.set(t,o)}return o}function g(e,t,i){var n=f(t,i,!1);return!b(n)&&!!n.has(e)}function v(e,t,i){var n=f(t,i,!1);if(!b(n))return n.get(e)}function m(e,t,i,n){f(i,n,!0).set(e,t)}function y(e,t){var i=[],n=f(e,t,!1);if(b(n))return i;for(var s=function(e){var t=k(e,o);if(!E(t))throw TypeError();var i=t.call(e);if(!S(i))throw TypeError();return i}(n.keys()),r=0;;){var a=function(e){var t=e.next();return!t.done&&t}(s);if(!a)return i.length=r,i;var c=a.value;try{i[r]=c}catch(e){try{(function(e){var t=e.return;t&&t.call(e)})(s)}finally{throw e}}r++}}function w(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function b(e){return void 0===e}function C(e){return null===e}function S(e){return"object"==typeof e?null!==e:"function"==typeof e}function I(e){var t=function(e,t){switch(w(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var i=3===t?"string":5===t?"number":"default",o=k(e,n);if(void 0!==o){var s=o.call(e,i);if(S(s))throw TypeError();return s}return function(e,t){if("string"===t){var i=e.toString;if(E(i)){var n=i.call(e);if(!S(n))return n}var o=e.valueOf;if(E(o)){var n=o.call(e);if(!S(n))return n}}else{var o=e.valueOf;if(E(o)){var n=o.call(e);if(!S(n))return n}var s=e.toString;if(E(s)){var n=s.call(e);if(!S(n))return n}}throw TypeError()}(e,"default"===i?"number":i)}(e,3);return"symbol"==typeof t?t:""+t}function _(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function E(e){return"function"==typeof e}function O(e){return"function"==typeof e}function k(e,t){var i=e[t];if(null!=i){if(!E(i))throw TypeError();return i}}function T(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l||t!==l)return t;var i=e.prototype,n=i&&Object.getPrototypeOf(i);if(null==n||n===Object.prototype)return t;var o=n.constructor;return"function"!=typeof o||o===e?t:o}function R(e){return e.__=void 0,delete e.__,e}e("decorate",function(e,t,i,n){if(b(i)){if(!_(e)||!O(t))throw TypeError();return function(e,t){for(var i=e.length-1;i>=0;--i){var n=(0,e[i])(t);if(!b(n)&&!C(n)){if(!O(n))throw TypeError();t=n}}return t}(e,t)}if(!_(e)||!S(t)||!S(n)&&!b(n)&&!C(n))throw TypeError();return C(n)&&(n=void 0),function(e,t,i,n){for(var o=e.length-1;o>=0;--o){var s=(0,e[o])(t,i,n);if(!b(s)&&!C(s)){if(!S(s))throw TypeError();n=s}}return n}(e,t,i=I(i),n)}),e("metadata",function(e,t){return function(i,n){if(!S(i)||!b(n)&&!function(e){switch(w(e)){case 3:case 4:return!0;default:return!1}}(n))throw TypeError();m(e,t,i,n)}}),e("defineMetadata",function(e,t,i,n){if(!S(i))throw TypeError();return b(n)||(n=I(n)),m(e,t,i,n)}),e("hasMetadata",function(e,t,i){if(!S(t))throw TypeError();return b(i)||(i=I(i)),function e(t,i,n){if(g(t,i,n))return!0;var o=T(i);return!C(o)&&e(t,o,n)}(e,t,i)}),e("hasOwnMetadata",function(e,t,i){if(!S(t))throw TypeError();return b(i)||(i=I(i)),g(e,t,i)}),e("getMetadata",function(e,t,i){if(!S(t))throw TypeError();return b(i)||(i=I(i)),function e(t,i,n){if(g(t,i,n))return v(t,i,n);var o=T(i);if(!C(o))return e(t,o,n)}(e,t,i)}),e("getOwnMetadata",function(e,t,i){if(!S(t))throw TypeError();return b(i)||(i=I(i)),v(e,t,i)}),e("getMetadataKeys",function(e,t){if(!S(e))throw TypeError();return b(t)||(t=I(t)),function e(t,i){var n=y(t,i),o=T(t);if(null===o)return n;var s=e(o,i);if(s.length<=0)return n;if(n.length<=0)return s;for(var r=new h,a=[],c=0;c<n.length;c++){var l=n[c],u=r.has(l);u||(r.add(l),a.push(l))}for(var d=0;d<s.length;d++){var l=s[d],u=r.has(l);u||(r.add(l),a.push(l))}return a}(e,t)}),e("getOwnMetadataKeys",function(e,t){if(!S(e))throw TypeError();return b(t)||(t=I(t)),y(e,t)}),e("deleteMetadata",function(e,t,i){if(!S(t))throw TypeError();b(i)||(i=I(i));var n=f(t,i,!1);if(b(n)||!n.delete(e))return!1;if(n.size>0)return!0;var o=p.get(t);return o.delete(i),o.size>0||(p.delete(t),!0)})})}(o||(o={})),function(e){e[e.Transient=0]="Transient",e[e.Singleton=1]="Singleton",e[e.ResolutionScoped=2]="ResolutionScoped",e[e.ContainerScoped=3]="ContainerScoped"}(s||(s={}));var tB=s,t$=function(e,t){return(t$=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function tq(e,t){function i(){this.constructor=e}t$(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function tz(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function tQ(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,o,s=i.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)r.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}return r}function tY(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(tQ(arguments[t]));return e}var tK="injectionTokens";function tJ(e,t){return function(i,n,o){var s=Reflect.getOwnMetadata(tK,i)||{};s[o]=t?{token:e,transform:t.transformToken,transformArgs:t.args||[]}:e,Reflect.defineMetadata(tK,s,i)}}function tX(e){return!!e.useClass}function tZ(e){return!!e.useFactory}var t0=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,i=this,n=!1;return new Proxy({},this.createHandler(function(){return n||(t=e(i.wrap()),n=!0),t}))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach(function(i){t[i]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t[0]=e(),Reflect[i].apply(void 0,tY(t))}}),t},e}();function t1(e){if(void 0===e)throw Error("Attempt to `delay` undefined. Constructor must be wrapped in a callback");return new t0(e)}function t2(e){return"string"==typeof e||"symbol"==typeof e}function t6(e){return"object"==typeof e&&"token"in e&&"transform"in e}function t3(e){return!!e.useToken}function t4(e){return void 0!=e.useValue}var t5=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),t8=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tq(t,e),t}(t5),t9=function(){this.scopedResolutions=new Map},t7=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tq(t,e),t}(t5),ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tq(t,e),t}(t5),it=function(){this.preResolution=new t7,this.postResolution=new ie},ii=new Map,io=new(function(){function e(e){this.parent=e,this._registry=new t8,this.interceptors=new it,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,i){if(void 0===i&&(i={lifecycle:tB.Transient}),this.ensureNotDisposed(),t3(n=tX(t)||t4(t)||t3(t)||tZ(t)?t:{useClass:t}))for(var n,o=[e],s=n;null!=s;){var r=s.useToken;if(o.includes(r))throw Error("Token registration cycle detected! "+tY(o,[r]).join(" -> "));o.push(r);var a=this._registry.get(r);s=a&&t3(a.provider)?a.provider:null}if((i.lifecycle===tB.Singleton||i.lifecycle==tB.ContainerScoped||i.lifecycle==tB.ResolutionScoped)&&(t4(n)||tZ(n)))throw Error('Cannot use lifecycle "'+tB[i.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:n,options:i}),this},e.prototype.registerType=function(e,t){return(this.ensureNotDisposed(),t2(t))?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),t2(e)){if(t2(t))return this.register(e,{useToken:t},{lifecycle:tB.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:tB.Singleton});throw Error('Cannot register a type name as a singleton without a "to" token')}var i=e;return t&&!t2(t)&&(i=t),this.register(e,{useClass:i},{lifecycle:tB.Singleton})},e.prototype.resolve=function(e,t){void 0===t&&(t=new t9),this.ensureNotDisposed();var i=this.getRegistration(e);if(!i&&t2(e))throw Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),i){var n=this.resolveRegistration(i,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}if("function"==typeof e||e instanceof t0){var n=this.construct(e,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}throw Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var i,n;if(this.interceptors.preResolution.has(e)){var o=[];try{for(var s=tz(this.interceptors.preResolution.getAll(e)),r=s.next();!r.done;r=s.next()){var a=r.value;"Once"!=a.options.frequency&&o.push(a),a.callback(e,t)}}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}this.interceptors.preResolution.setAll(e,o)}},e.prototype.executePostResolutionInterceptor=function(e,t,i){var n,o;if(this.interceptors.postResolution.has(e)){var s=[];try{for(var r=tz(this.interceptors.postResolution.getAll(e)),a=r.next();!a.done;a=r.next()){var c=a.value;"Once"!=c.options.frequency&&s.push(c),c.callback(e,t,i)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(e,s)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===tB.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var i,n=e.options.lifecycle===tB.Singleton,o=e.options.lifecycle===tB.ContainerScoped,s=n||o;return i=t4(e.provider)?e.provider.useValue:t3(e.provider)?s?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):tX(e.provider)?s?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):tZ(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===tB.ResolutionScoped&&t.scopedResolutions.set(e,i),i},e.prototype.resolveAll=function(e,t){var i=this;void 0===t&&(t=new t9),this.ensureNotDisposed();var n=this.getAllRegistrations(e);if(!n&&t2(e))throw Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"All"),n){var o=n.map(function(e){return i.resolveRegistration(e,t)});return this.executePostResolutionInterceptor(e,o,"All"),o}var s=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,s,"All"),s},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var i=tz(this._registry.entries()),n=i.next();!n.done;n=i.next()){var o=tQ(n.value,2),s=o[0],r=o[1];this._registry.setAll(s,r.filter(function(e){return!t4(e.provider)}).map(function(e){return e.instance=void 0,e}))}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){this.ensureNotDisposed();var t,i,n=new e(this);try{for(var o=tz(this._registry.entries()),s=o.next();!s.done;s=o.next()){var r=tQ(s.value,2),a=r[0],c=r[1];c.some(function(e){return e.options.lifecycle===tB.ContainerScoped})&&n._registry.setAll(a,c.map(function(e){return e.options.lifecycle===tB.ContainerScoped?{provider:e.provider,options:e.options}:e}))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}return n},e.prototype.beforeResolution=function(e,t,i){void 0===i&&(i={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:i})},e.prototype.afterResolution=function(e,t,i){void 0===i&&(i={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:i})},e.prototype.dispose=function(){var e,t,i,n;return e=this,t=void 0,i=void 0,n=function(){var e;return function(e,t){var i,n,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,n=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){r=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(6===s[0]&&r.label<o[1]){r.label=o[1],o=s;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(s);break}o[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],n=0}finally{i=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}(this,function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach(function(t){var i=t.dispose();i&&e.push(i)}),[4,Promise.all(e)];case 1:return t.sent(),[2]}})},new(i||(i=Promise))(function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(r,a)}c((n=n.apply(e,t||[])).next())})},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var i=this;if(e instanceof t0)return e.createProxy(function(e){return i.resolve(e,t)});var n=function(){var n=ii.get(e);if(!n||0===n.length){if(0===e.length)return new e;throw Error('TypeInfo not known for "'+e.name+'"')}var o=n.map(i.resolveParams(t,e));return new(e.bind.apply(e,tY([void 0],o)))}();return"function"!=typeof n.dispose||n.dispose.length>0||this.disposables.add(n),n},e.prototype.resolveParams=function(e,t){var i=this;return function(n,o){var s,r,a,c,l,u,d;try{if("object"==typeof n&&"token"in n&&"multiple"in n){if(t6(n))return n.multiple?(s=i.resolve(n.transform)).transform.apply(s,tY([i.resolveAll(n.token)],n.transformArgs)):(r=i.resolve(n.transform)).transform.apply(r,tY([i.resolve(n.token,e)],n.transformArgs));return n.multiple?i.resolveAll(n.token):i.resolve(n.token,e)}if(t6(n))return(a=i.resolve(n.transform,e)).transform.apply(a,tY([i.resolve(n.token,e)],n.transformArgs));return i.resolve(n,e)}catch(e){throw Error((l="Cannot inject the dependency "+(null===(c=void 0===(d=tQ(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1])?null:d)?"at position #"+o:'"'+c.split(",")[o].trim()+'" at position #'+o)+' of "'+t.name+'" constructor. Reason:',void 0===u&&(u="    "),tY([l],e.message.split("\n").map(function(e){return u+e})).join("\n")))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw Error("This container has been disposed, you cannot interact with a disposed container")},e}()),is=function(e){return tJ(e)},ir=function(){return function(e){var t,i;ii.set(e,(t=Reflect.getMetadata("design:paramtypes",e)||[],Object.keys(i=Reflect.getOwnMetadata(tK,e)||{}).forEach(function(e){t[+e]=i[e]}),t))}},ia=function(){return function(e){ir()(e),io.registerSingleton(e)}},ic=function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return tJ(e,{transformToken:t,args:i})};if("undefined"==typeof Reflect||!Reflect.getMetadata)throw Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");var il={};il=function(){"use strict";function e(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}return function t(i,n){function o(t,o,s){if("undefined"!=typeof document){"number"==typeof(s=e({},n,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var r="";for(var a in s)s[a]&&(r+="; "+a,!0!==s[a]&&(r+="="+s[a].split(";")[0]));return document.cookie=t+"="+i.write(o,t)+r}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],n={},o=0;o<t.length;o++){var s=t[o].split("="),r=s.slice(1).join("=");try{var a=decodeURIComponent(s[0]);if(n[a]=i.read(r,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(t,i){o(t,"",e({},i,{expires:-1}))},withAttributes:function(i){return t(this.converter,e({},this.attributes,i))},withConverter:function(i){return t(e({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(i)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}();let iu="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var id={randomUUID:iu};let ih=new Uint8Array(16);function ip(){if(!e&&!(e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(ih)}let ig=[];for(let e=0;e<256;++e)ig.push((e+256).toString(16).slice(1));let iv=Symbol("COOKIES"),im=Symbol("WINDOW"),iy=Symbol("UUID"),iw=Symbol("SENTRY"),ib=class{constructor(e){this.window=e}get(){var e;return null===(e=this.window.ads)||void 0===e?void 0:e.context}};ib=tT([ir(),tR(0,is(im)),tA("design:paramtypes",["function"==typeof(r="undefined"!=typeof Window&&Window)?r:Object])],ib);let iC=class{getBrowser(){let e;let{appName:t,appVersion:i,userAgent:n}=window.navigator,o=n.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(o[1])?`IE ${(e=/\brv[ :]+(\d+)/g.exec(n)||[""])[1]||""}`:"Chrome"===o[1]&&null!==(e=n.match(/\b(OPR|Edg)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera").replace("Edg","Edge"):(o=o[2]?[o[1],o[2]]:[t,i,"-?"],null!==(e=n.match(/version\/(\d+)/i))&&o.splice(1,1,e[1]),o.join(" "))}};iC=tT([ia()],iC);var iS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iI=window.device,i_={},iE=[];window.device=i_;var iO=window.document.documentElement,ik=window.navigator.userAgent.toLowerCase(),iT=["googletv","viera","smarttv","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","pov_tv","hbbtv","ce-html"];function iR(e,t){return -1!==e.indexOf(t)}function iA(e){return iR(ik,e)}function iL(e){return iO.className.match(RegExp(e,"i"))}function iP(e){var t=null;iL(e)||(t=iO.className.replace(/^\s+|\s+$/g,""),iO.className=t+" "+e)}function iD(e){iL(e)&&(iO.className=iO.className.replace(" "+e,""))}function ij(){i_.landscape()?(iD("portrait"),iP("landscape"),iN("landscape")):(iD("landscape"),iP("portrait"),iN("portrait")),iM()}function iN(e){for(var t=0;t<iE.length;t++)iE[t](e)}i_.macos=function(){return iA("mac")},i_.ios=function(){return i_.iphone()||i_.ipod()||i_.ipad()},i_.iphone=function(){return!i_.windows()&&iA("iphone")},i_.ipod=function(){return iA("ipod")},i_.ipad=function(){var e="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;return iA("ipad")||e},i_.android=function(){return!i_.windows()&&iA("android")},i_.androidPhone=function(){return i_.android()&&iA("mobile")},i_.androidTablet=function(){return i_.android()&&!iA("mobile")},i_.blackberry=function(){return iA("blackberry")||iA("bb10")},i_.blackberryPhone=function(){return i_.blackberry()&&!iA("tablet")},i_.blackberryTablet=function(){return i_.blackberry()&&iA("tablet")},i_.windows=function(){return iA("windows")},i_.windowsPhone=function(){return i_.windows()&&iA("phone")},i_.windowsTablet=function(){return i_.windows()&&iA("touch")&&!i_.windowsPhone()},i_.fxos=function(){return(iA("(mobile")||iA("(tablet"))&&iA(" rv:")},i_.fxosPhone=function(){return i_.fxos()&&iA("mobile")},i_.fxosTablet=function(){return i_.fxos()&&iA("tablet")},i_.meego=function(){return iA("meego")},i_.cordova=function(){return window.cordova&&"file:"===location.protocol},i_.nodeWebkit=function(){return"object"===iS(window.process)},i_.mobile=function(){return i_.androidPhone()||i_.iphone()||i_.ipod()||i_.windowsPhone()||i_.blackberryPhone()||i_.fxosPhone()||i_.meego()},i_.tablet=function(){return i_.ipad()||i_.androidTablet()||i_.blackberryTablet()||i_.windowsTablet()||i_.fxosTablet()},i_.desktop=function(){return!i_.tablet()&&!i_.mobile()},i_.television=function(){for(var e=0;e<iT.length;){if(iA(iT[e]))return!0;e++}return!1},i_.portrait=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?iR(screen.orientation.type,"portrait"):i_.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90!==Math.abs(window.orientation):window.innerHeight/window.innerWidth>1},i_.landscape=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?iR(screen.orientation.type,"landscape"):i_.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90===Math.abs(window.orientation):window.innerHeight/window.innerWidth<1},i_.noConflict=function(){return window.device=iI,this},i_.ios()?i_.ipad()?iP("ios ipad tablet"):i_.iphone()?iP("ios iphone mobile"):i_.ipod()&&iP("ios ipod mobile"):i_.macos()?iP("macos desktop"):i_.android()?i_.androidTablet()?iP("android tablet"):iP("android mobile"):i_.blackberry()?i_.blackberryTablet()?iP("blackberry tablet"):iP("blackberry mobile"):i_.windows()?i_.windowsTablet()?iP("windows tablet"):i_.windowsPhone()?iP("windows mobile"):iP("windows desktop"):i_.fxos()?i_.fxosTablet()?iP("fxos tablet"):iP("fxos mobile"):i_.meego()?iP("meego mobile"):i_.nodeWebkit()?iP("node-webkit"):i_.television()?iP("television"):i_.desktop()&&iP("desktop"),i_.cordova()&&iP("cordova"),i_.onChangeOrientation=function(e){"function"==typeof e&&iE.push(e)};var ix="resize";function iV(e){for(var t=0;t<e.length;t++)if(i_[e[t]]())return e[t];return"unknown"}function iM(){i_.orientation=iV(["portrait","landscape"])}Object.prototype.hasOwnProperty.call(window,"onorientationchange")&&(ix="orientationchange"),window.addEventListener?window.addEventListener(ix,ij,!1):window.attachEvent?window.attachEvent(ix,ij):window[ix]=ij,ij(),i_.type=iV(["mobile","tablet","desktop"]),i_.os=iV(["ios","iphone","ipad","ipod","android","blackberry","macos","windows","fxos","meego","television"]),iM();let iU=class{getDeviceType(){return i_.tablet()?"tablet":i_.mobile()?"smartphone":"desktop"}};iU=tT([ia()],iU);class iG{static getURLSearchParams(){let e=window.location.search.substring(1);return new URLSearchParams(e)}static get(e){let t=iG.getURLSearchParams();return t.get(e)}static stringify(e){let t=new URLSearchParams(e);return t.sort(),t.toString()}}class iF{transform(e,t){return e.setLoggerGroup(t)}}let iW=class{constructor(e){var t,i;this.logGroup="Global",this.debugGroup=this.getDebugGroup()||"",this.groups=this.debugGroup.split(","),this.initTime=null!==(i=null===(t=null==e?void 0:e.performance)||void 0===t?void 0:t.timeOrigin)&&void 0!==i?i:Date.now()}setLoggerGroup(e){return this.logGroup=e,this}getTimeDelta(){let e=Date.now();return e-this.initTime}getDebugGroup(){return iG.get("identity_debug")}getTimeDeltaFixed(){let e=this.getTimeDelta();return(e/1e3).toFixed(4)}info(...e){this.loggingEnabled()&&console.info(`${this.getTimeDeltaFixed()}s		 [IE] ${this.logGroup}`,e)}warn(...e){this.loggingEnabled()&&console.warn(`${this.getTimeDeltaFixed()}s		 [IE] ${this.logGroup}`,e)}error(...e){this.loggingEnabled()&&console.error(`${this.getTimeDeltaFixed()}s		 [IE] ${this.logGroup}`,e)}loggingEnabled(){return""!==this.debugGroup&&("1"===this.debugGroup||-1!==this.groups.indexOf(this.logGroup))}};iW=tT([ir(),tR(0,is(im)),tA("design:paramtypes",["function"==typeof(a="undefined"!=typeof Window&&Window)?a:Object])],iW);let iH=["ai","aw","ax","at","be","bg","bm","vg","bq","ky","hr","cw","cy","cz","dk","ee","fk","fo","fi","fr","gf","pf","tf","de","gi","gr","gl","gp","hu","is","ie","im","it","re","lv","li","lt","lu","mq","mt","yt","ms","nl","nc","no","pn","pl","pt","ro","bl","sh","mf","pm","bq","sx","sk","si","es","se","ch","tc","gb","uk","wf","ad","br","cn"],iB=class{constructor(e,t,i){this.cookiesManager=e,this.window=t,this.logger=i}get(){return this.geoData||(this.geoData=this.getGeoData()),this.geoData}set(e){this.geoData=e}getGeoData(){let e=this.getGeoDataFromCookie();return Object.keys(e).length?e:this.getGeoDataFromOneTrust()}getGeoDataFromCookie(){let e=this.cookiesManager.get("Geo");if(!e)return{};let t=decodeURIComponent(e);try{return JSON.parse(t)}catch(e){return this.logger.error("Invalid JSON in the cookie",e),{}}}getGeoDataFromOneTrust(){return this.window.OneTrust&&this.window.OneTrust.getGeolocationData()?{country:this.window.OneTrust.getGeolocationData().country}:{}}getCountryCode(){var e,t;return null===(t=null===(e=this.get())||void 0===e?void 0:e.country)||void 0===t?void 0:t.toLowerCase()}getRegionCode(){var e,t;return null===(t=null===(e=this.get())||void 0===e?void 0:e.region)||void 0===t?void 0:t.toLowerCase()}getContinentCode(){var e,t;return null===(t=null===(e=this.get())||void 0===e?void 0:e.continent)||void 0===t?void 0:t.toLowerCase()}isGdprCountry(){return iH.includes(this.getCountryCode())}};iB=tT([ia(),tR(0,is(iv)),tR(1,is(im)),tR(2,ic(iW,iF,"Geo")),tA("design:paramtypes",["function"==typeof(c="undefined"!=typeof CookiesManager&&CookiesManager)?c:Object,"function"==typeof(l="undefined"!=typeof Window&&Window)?l:Object,"function"==typeof(u=void 0!==iW&&iW)?u:Object])],iB);let i$=class{get(e){return tL(this,void 0,void 0,function*(){let t=yield fetch(e,{method:"GET",mode:"cors"});if(!t.ok||200!==t.status)throw Error(`HTTP error ${e}! Status: ${t.status}`);return t})}};i$=tT([ir()],i$);let iq=class{get(){return["fandom.com","tvguide.com","metacritic.com","gamespot.com","giantbomb.com","muthead.com","futhead.com","fandom-ae-assets.s3.amazonaws.com","fanatical.com"].find(e=>window.location.hostname.includes(e))?"https://services.fandom.com/":"https://services.fandom-dev."+(location.hostname.match(/(?!\.)(pl|us)$/)||["us"])[0]+"/"}};iq=tT([ia()],iq);let iz=class{constructor(e,t,i,n,o){this.cookiesManager=e,this.httpClient=t,this.logger=i,this.geo=n,this.serviceBaseUrl=o,this.geoIPUrl=this.serviceBaseUrl.get()+"geoip/location"}setGeoCookieIfNotExist(){return tL(this,void 0,void 0,function*(){if(this.cookiesManager.get("Geo")){this.logger.info("Geo cookie already exists");return}let e=yield this.httpClient.get(this.geoIPUrl),{country_code:t,region:i,continent_code:n}=yield e.json(),o={country:t,region:i,continent:n},s=JSON.stringify(o);this.cookiesManager.set("Geo",s,{expires:365}),this.geo.set(o),this.logger.info("Geo cookie set")})}};iz=tT([ia(),tR(0,is(iv)),tR(1,is(i$)),tR(2,ic(iW,iF,"GeoCookie")),tR(3,is(iB)),tR(4,is(iq)),tA("design:paramtypes",["function"==typeof(d="undefined"!=typeof CookiesManager&&CookiesManager)?d:Object,"function"==typeof(h=void 0!==i$&&i$)?h:Object,"function"==typeof(p=void 0!==iW&&iW)?p:Object,"function"==typeof(f=void 0!==iB&&iB)?f:Object,"function"==typeof(g=void 0!==iq&&iq)?g:Object])],iz);let iQ=class{get(){var e,t,i;let n=iG.get("identity_icbm_app");return n||(void 0!==window.mw&&(null===(i=null===(t=null===(e=window.ads)||void 0===e?void 0:e.context)||void 0===t?void 0:t.opts)||void 0===i?void 0:i.platformName)!==void 0?window.ads.context.opts.platformName:this.checkHostname())}checkHostname(){let{hostname:e,pathname:t}=window.location;switch(!0){case e.includes("fandom"):return e.includes("bingebot")?"bingebot":"f2";case e.includes("futhead"):return"futhead";case e.includes("muthead"):return"muthead";case e.includes("gamespot"):return e.includes("comicvine")?"comicvine":e.includes("gamefaqs")?"gamefaqs":"gamespot";case e.includes("metacritic"):return t.includes("news")?"metacritic-neutron":"metacritic";case e.includes("tvguide"):return"tvguide";case e.includes("giantbomb"):return"giantbomb";default:return"fandomdesktop"}}};iQ=tT([ia()],iQ);let iY=class{constructor(e,t){this.platform=e,this.device=t,this.skinMap={muthead:"turf",futhead:"turf",giantbomb:"giantbomb",gamefaqs:"gamefaqs",gamespot:"gamespot",metacritic:"metacritic","metacritic-neutron":"metacritic_neutron",comicvine:"comicvine",f2:"fandom",tvguide:"tvguide",fandomdesktop:"ucp",fandommobile:"ucp"}}get(){let e=this.platform.get(),t="desktop"===this.device.getDeviceType()?"desktop":"mobile";return this.skinMap[e]?this.skinMap[e]+"_"+t:"unknown"}};iY=tT([ia(),tR(0,is(iQ)),tR(1,is(iU)),tA("design:paramtypes",["function"==typeof(v=void 0!==iQ&&iQ)?v:Object,"function"==typeof(m=void 0!==iU&&iU)?m:Object])],iY);let iK=class{constructor(e){this.window=e}getItem(e){let t=null;try{return t=this.window.localStorage.getItem(e),JSON.parse(t)}catch(e){return t}}setItem(e,t){let i=t instanceof Object?JSON.stringify(t):t;try{this.window.localStorage.setItem(e,i)}catch(e){}}removeItem(e){return this.window.localStorage.removeItem(e)}};iK=tT([ia(),tR(0,is(im)),tA("design:paramtypes",["function"==typeof(y="undefined"!=typeof Window&&Window)?y:Object])],iK);let iJ=class{constructor(e){this.window=e}getItem(e){let t=this.window.sessionStorage.getItem(e);try{return JSON.parse(t)}catch(e){return t}}setItem(e,t){let i=t instanceof Object?JSON.stringify(t):t;this.window.sessionStorage.setItem(e,i)}removeItem(e){return this.window.sessionStorage.removeItem(e)}};iJ=tT([ia(),tR(0,is(im)),tA("design:paramtypes",["function"==typeof(w="undefined"!=typeof Window&&Window)?w:Object])],iJ);let iX=class{static extract(e){let t=e.split(".");if(t.length<2)return e;let i=`.${t[t.length-2]}.${t[t.length-1]}`;return[".co.jp",".co.nz",".co.uk"].indexOf(i)>=0&&(i=`.${t[t.length-3]}${i}`),i}};iX=tT([ir()],iX);let iZ=class{constructor(e){this.window=e}get(e,t=null){var i,n,o;return null!==(o=null===(n=null===(i=this.window.mw)||void 0===i?void 0:i.config)||void 0===n?void 0:n.get(e))&&void 0!==o?o:t}};iZ=tT([ia(),tR(0,is(im)),tA("design:paramtypes",["function"==typeof(b="undefined"!=typeof Window&&Window)?b:Object])],iZ);let i0=class{createScript(e,t="text/javascript",i=!0,n=null,o={},s={}){let r=document.createElement("script");if(r.async=i,r.defer=!i,r.type=t,r.src=e,Object.keys(o).forEach(e=>{r.setAttribute(e,o[e])}),Object.keys(s).forEach(e=>{r.dataset[e]=s[e]}),"string"==typeof n){let e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(r,e)}else{let e=n||document.body;e.append(r)}return r}loadScript(e,t="text/javascript",i=!0,n=null,o={},s={}){return new Promise((r,a)=>{let c=this.createScript(e,t,i,n,o,s);c.onload=r,c.onerror=a})}};i0=tT([ir()],i0);let i1=class{constructor(e,t,i,n,o){this.cookiesManager=e,this.window=t,this.wikiConfig=i,this.context=n,this.logger=o,this.ageGateCookie="ag",this.ageGateLegacyCookie="age_gate",this.ageGateExpiryMs=31536e6}init(e){var t,i;return tL(this,void 0,void 0,function*(){let n=!!(null===(i=null===(t=this.context.get())||void 0===t?void 0:t.targeting)||void 0===i?void 0:i.directedAtChildren),o=n&&this.wikiConfig.get("wgAgeGateEnabled",!1);if(!o)return this.logger.info("disabled"),Promise.resolve();let s=this.cookiesManager.get(this.ageGateLegacyCookie);if(s)return this.updateLegacyCookie(s),Promise.resolve();let r=this.cookiesManager.get(this.ageGateCookie);return r||(yield this.waitForAgeGateDataAndSetCookie(e)),Promise.resolve()})}waitForAgeGateDataAndSetCookie(e){return tL(this,void 0,void 0,function*(){return new Promise(t=>{e.on(oo.AGE_GATE_DATA,({payload:e})=>{this.setCookie(e),t()})})})}setCookie(e){var t,i;e||this.logger.warn("Payload data missing, using defaults");let n=null!==(t=null==e?void 0:e.adult)&&void 0!==t&&t,o=null!==(i=null==e?void 0:e.timestamp)&&void 0!==i?i:Date.now();this.cookiesManager.set(this.ageGateCookie,n?"1":"0",{domain:this.getTopLevelDomain(),expires:new Date(o+this.ageGateExpiryMs)})}updateLegacyCookie(e){if(e.length>=3){let t=e.split("|");this.setCookie({adult:"1"===t[1],timestamp:Date.now()})}this.cookiesManager.remove(this.ageGateLegacyCookie,{domain:this.getTopLevelDomain()})}getTopLevelDomain(){let e=this.window.location.hostname;return iX.extract(e)}};i1=tT([ia(),tR(0,is(iv)),tR(1,is(im)),tR(2,is(iZ)),tR(3,is(ib)),tR(4,ic(iW,iF,"AgeGate")),tA("design:paramtypes",["function"==typeof(C="undefined"!=typeof CookiesManager&&CookiesManager)?C:Object,"function"==typeof(S="undefined"!=typeof Window&&Window)?S:Object,"function"==typeof(I=void 0!==iZ&&iZ)?I:Object,"function"==typeof(_=void 0!==ib&&ib)?_:Object,"function"==typeof(E=void 0!==iW&&iW)?E:Object])],i1);let i2=class{generate(){let e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-",t="";for(;t.length<10;)t+=e[Math.random()*e.length|0];return t}};i2=tT([ir()],i2);class i6{constructor(e){this.options=e,this.tags={},this.errorQueue=[]}get inserted(){return Array.from(document.getElementsByTagName("script")).some(e=>e.src===i6.SENTRY_SCRIPT_CDN_URL)}get shouldLoad(){return Math.random()<this.options.sampleRate&&void 0!==i6.ALLOWED_URLS.find(e=>window.location.hostname.includes(e))}get loaded(){return void 0!==window.Sentry}get initialized(){return void 0!==this.hub}setTags(e){this.tags=e}captureException(e){if(console.error(`[IE] (${this.options.release} ${this.options.environment}) Error captured:`,e),"development"!==this.options.environment&&this.shouldLoad){if(!this.inserted){this.errorQueue.push(e),this.loadSentry();return}if(!this.loaded){this.errorQueue.push(e),(function(e,t=10,i=50){return new Promise((n,o)=>{let s=0,r=setInterval(()=>{e()&&(clearInterval(r),n()),s++>t&&(clearInterval(r),o())},i)})})(()=>this.loaded,10,100).then(()=>{this.createSentryInstance(),this.flushErrorQueue()});return}this.initialized||this.createSentryInstance(),this.hub.captureException(e)}}loadSentry(){return new Promise(e=>{let t=document.createElement("script");t.defer=!0,t.src=i6.SENTRY_SCRIPT_CDN_URL,t.crossOrigin="anonymous",t.integrity=i6.SENTRY_SCRIPT_INTEGRITY,t.onload=()=>{this.createSentryInstance(),this.flushErrorQueue(),e()};let i=document.getElementsByTagName("script")[0];i.parentNode.append(t)})}createSentryInstance(){let{Breadcrumbs:e,BrowserClient:t,Dedupe:i,defaultStackParser:n,HttpContext:o,Hub:s,LinkedErrors:r,makeFetchTransport:a}=window.Sentry,c=Object.assign(Object.assign({},this.options),{sampleRate:1,transport:a,stackParser:n,integrations:[new e,new i,new o,new r]}),l=new t(c);this.hub=new s(l),this.hub.setTags(Object.assign({url:window.location.href,userAgent:window.navigator.userAgent},this.tags))}flushErrorQueue(){this.errorQueue.forEach(e=>{var t;return null===(t=this.hub)||void 0===t?void 0:t.captureException(e)})}}i6.ALLOWED_URLS=["fandom.com","futhead.com","gamespot.com","giantbomb.com","metacritic.com","muthead.com","tvguide.com"],i6.SENTRY_SCRIPT_CDN_URL="//browser.sentry-cdn.com/7.55.2/bundle.min.js",i6.SENTRY_SCRIPT_INTEGRITY="sha384-grzsqzUax9BbmJWNgYTLmejARf1orUEVEvvg2sXJ60jMyjmzW/Eh8hrCFkSu6GNm";let i3=class{constructor(e){this.sentry=e}resolve(e,t,i){var n;e.geoRequiresConsent&&e.gdprConsent||e.geoRequiresSignal&&!e.ccpaSignal||!e.geoRequiresSignal&&!e.geoRequiresConsent?(this.consentGiven=!0,null===(n=t())||void 0===n||n.catch(e=>this.sentry.captureException(e))):(e.geoRequiresSignal&&e.ccpaSignal||e.geoRequiresConsent&&!e.gdprConsent)&&(this.consentGiven=!1,i())}getConsents(){return this.consentGiven}};i3=tT([ia(),tR(0,is(iw)),tA("design:paramtypes",[Object])],i3);let i4={".fanatical.com":"0ab0e172-dc9c-44b9-8a58-c80d9ba4fae0",".futhead.com":"82c642a4-d3a9-4a78-a310-21a7b49ab17b",".gamespot.com":"73588546-b116-4dbc-ab64-9db97e11fc0d",".metacritic.com":"50e16f1d-a929-4cc0-80a7-3c5c303eea6a",".muthead.com":"fb34a16e-696d-4748-af9f-96f3b9e2b4da",".tvguide.com":"ffc22311-f4da-4e03-a1ad-32aecd522c5b",".fandom.com":"dea70a1b-c82d-4fe0-86ff-5e164b0a6022"},i5=[{url:"https://cdn.cookielaw.org/scripttemplates/otSDKStub.js",options:{}},{url:"https://cdn.cookielaw.org/opt-out/otCCPAiab.js",options:{charSet:"UTF-8",type:"text/javascript","ccpa-opt-out-ids":"C0004","ccpa-opt-out-geo":"us","ccpa-opt-out-lspa":"false"}},{url:"https://cdn.cookielaw.org/consent/tcf.stub.js",options:{charSet:"UTF-8"}}],i8=class{constructor(e,t,i,n,o){this.cookiesManager=e,this.window=t,this.assetLoader=i,this.geo=n,this.logger=o,this.trackingGroup="C0004:1",this.testMode=!1,this.replaceDoNotSellLink(),this.testMode=!!iG.get("ot_test"),this.consentGiven=new Promise(e=>this.resolveConsent=e);let s=this.oneTrustModalClosed();s&&this.consentsUpdated(),this.oneTrustLoaded()||this.loadOneTrustScripts(),"us"===this.geo.getCountryCode()&&this.consentsUpdated(),this.subscribe()}oneTrustLoaded(){return!!(this.window.OneTrust||this.window.OneTrustStub)}replaceDoNotSellLink(){try{let e=document.querySelector('a[href$="do-not-sell-my-info"]');e.href="#",e.classList.add("ot-sdk-show-settings")}catch(e){this.logger.error("Could not prepare Opt-out button",e)}}oneTrustModalClosed(){let e=this.cookiesManager.get("OptanonAlertBoxClosed");return e&&!!e}subscribe(){let e=this.window.OptanonWrapper;this.window.OptanonWrapper=()=>{let t=this.oneTrustModalClosed();(t||"us"===this.geo.getCountryCode())&&(this.consentsUpdated(),null==e||e())}}oneTrustCookieExists(){return!!this.cookiesManager.get("OptanonConsent")}readTrackingConsents(){var e;let t=this.cookiesManager.get("OptanonConsent"),i=(null===(e=null==t?void 0:t.split("groups=").pop())||void 0===e?void 0:e.split(";")[0])||"";return i.length&&t.includes("groups")?i.includes(this.trackingGroup):"us"===this.geo.getCountryCode()}consentsUpdated(){if(!this.oneTrustCookieExists())return;let e=this.geo.getCountryCode(),t="us"===e?!this.readTrackingConsents():this.readTrackingConsents();e&&this.resolveConsent({gdprConsent:!iH.includes(e)||t,geoRequiresConsent:iH.includes(e),geoRequiresSignal:"us"===e,ccpaSignal:"us"===e&&t})}loadOneTrustScripts(){this.logger.info("Loading OneTrust scripts"),i5.forEach(e=>{this.assetLoader.loadScript(e.url,"text/javascript",!1,null,Object.assign(Object.assign({},e.options),{"data-domain-script":this.getDomainId()}))})}getDomainId(){let e=iX.extract(this.window.location.hostname),t=i4[e]||i4[".fandom.com"];return this.testMode?`${t}-test`:t}};i8=tT([ia(),tR(0,is(iv)),tR(1,is(im)),tR(2,is(i0)),tR(3,is(iB)),tR(4,ic(iW,iF,"OneTrust")),tA("design:paramtypes",["function"==typeof(O="undefined"!=typeof CookiesManager&&CookiesManager)?O:Object,"function"==typeof(k="undefined"!=typeof Window&&Window)?k:Object,"function"==typeof(T=void 0!==i0&&i0)?T:Object,"function"==typeof(R=void 0!==iB&&iB)?R:Object,"function"==typeof(A=void 0!==iW&&iW)?A:Object])],i8),function(e){e.PING="ping",e.GET_TC_DATA="getTCData",e.GET_IN_APP_TC_DATA="getInAppTCData",e.GET_VENDOR_LIST="getVendorList",e.ADD_EVENT_LISTENER="addEventListener",e.REMOVE_EVENT_LISTENER="removeEventListener"}(L||(L={})),function(e){e.STUB="stub",e.LOADING="loading",e.LOADED="loaded",e.ERROR="error"}(P||(P={})),function(e){e.VISIBLE="visible",e.HIDDEN="hidden",e.DISABLED="disabled"}(D||(D={})),function(e){e.TC_LOADED="tcloaded",e.CMP_UI_SHOWN="cmpuishown",e.USER_ACTION_COMPLETE="useractioncomplete"}(j||(j={}));class i9{listenerId;callback;next;param;success=!0;constructor(e,t,i,n){Object.assign(this,{callback:e,listenerId:i,param:t,next:n});try{this.respond()}catch(e){this.invokeCallback(null)}}invokeCallback(e){let t=null!==e;"function"==typeof this.next?this.callback(this.next,e,t):this.callback(e,t)}}class i7 extends i9{respond(){this.throwIfParamInvalid(),this.invokeCallback(new no(this.param,this.listenerId))}throwIfParamInvalid(){if(void 0!==this.param&&(!Array.isArray(this.param)||!this.param.every(Number.isInteger)))throw Error("Invalid Parameter")}}class ne{eventQueue=new Map;queueNumber=0;add(e){return this.eventQueue.set(this.queueNumber,e),this.queueNumber++}remove(e){return this.eventQueue.delete(e)}exec(){this.eventQueue.forEach((e,t)=>{new i7(e.callback,e.param,t,e.next)})}clear(){this.queueNumber=0,this.eventQueue.clear()}get size(){return this.eventQueue.size}}class nt{static apiVersion="2";static tcfPolicyVersion;static eventQueue=new ne;static cmpStatus=P.LOADING;static disabled=!1;static displayStatus=D.HIDDEN;static cmpId;static cmpVersion;static eventStatus;static gdprApplies;static tcModel;static tcString;static reset(){delete this.cmpId,delete this.cmpVersion,delete this.eventStatus,delete this.gdprApplies,delete this.tcModel,delete this.tcString,delete this.tcfPolicyVersion,this.cmpStatus=P.LOADING,this.disabled=!1,this.displayStatus=D.HIDDEN,this.eventQueue.clear()}}class ni{cmpId=nt.cmpId;cmpVersion=nt.cmpVersion;gdprApplies=nt.gdprApplies;tcfPolicyVersion=nt.tcfPolicyVersion}class nn extends ni{cmpStatus=P.ERROR}class no extends ni{tcString;listenerId;eventStatus;cmpStatus;isServiceSpecific;useNonStandardStacks;publisherCC;purposeOneTreatment;outOfBand;purpose;vendor;specialFeatureOptins;publisher;constructor(e,t){if(super(),this.eventStatus=nt.eventStatus,this.cmpStatus=nt.cmpStatus,this.listenerId=t,nt.gdprApplies){let t=nt.tcModel;this.tcString=nt.tcString,this.isServiceSpecific=t.isServiceSpecific,this.useNonStandardStacks=t.useNonStandardStacks,this.purposeOneTreatment=t.purposeOneTreatment,this.publisherCC=t.publisherCountryCode,this.outOfBand={allowedVendors:this.createVectorField(t.vendorsAllowed,e),disclosedVendors:this.createVectorField(t.vendorsDisclosed,e)},this.purpose={consents:this.createVectorField(t.purposeConsents),legitimateInterests:this.createVectorField(t.purposeLegitimateInterests)},this.vendor={consents:this.createVectorField(t.vendorConsents,e),legitimateInterests:this.createVectorField(t.vendorLegitimateInterests,e)},this.specialFeatureOptins=this.createVectorField(t.specialFeatureOptins),this.publisher={consents:this.createVectorField(t.publisherConsents),legitimateInterests:this.createVectorField(t.publisherLegitimateInterests),customPurpose:{consents:this.createVectorField(t.publisherCustomConsents),legitimateInterests:this.createVectorField(t.publisherCustomLegitimateInterests)},restrictions:this.createRestrictions(t.publisherRestrictions)}}}createRestrictions(e){let t={};if(e.numRestrictions>0){let i=e.getMaxVendorId();for(let n=1;n<=i;n++){let i=n.toString();e.getRestrictions(n).forEach(e=>{let n=e.purposeId.toString();t[n]||(t[n]={}),t[n][i]=e.restrictionType})}}return t}createVectorField(e,t){return t?t.reduce((t,i)=>(t[String(i)]=e.has(Number(i)),t),{}):[...e].reduce((e,t)=>(e[t[0].toString(10)]=t[1],e),{})}}class ns extends no{constructor(e){super(e),delete this.outOfBand}createVectorField(e){return[...e].reduce((e,t)=>e+=t[1]?"1":"0","")}createRestrictions(e){let t={};if(e.numRestrictions>0){let i=e.getMaxVendorId();e.getRestrictions().forEach(e=>{t[e.purposeId.toString()]="_".repeat(i)});for(let n=0;n<i;n++){let i=n+1;e.getRestrictions(i).forEach(e=>{let i=e.restrictionType.toString(),o=e.purposeId.toString(),s=t[o].substr(0,n),r=t[o].substr(n+1);t[o]=s+i+r})}}return t}}class nr extends ni{cmpLoaded=!0;cmpStatus=nt.cmpStatus;displayStatus=nt.displayStatus;apiVersion=String(nt.apiVersion);gvlVersion;constructor(){super(),nt.tcModel&&nt.tcModel.vendorListVersion&&(this.gvlVersion=+nt.tcModel.vendorListVersion)}}class na extends i9{respond(){this.invokeCallback(new nr)}}class nc extends i7{respond(){this.throwIfParamInvalid(),this.invokeCallback(new ns(this.param))}}class nl extends Error{constructor(e){super(e),this.name="DecodingError"}}class nu extends Error{constructor(e){super(e),this.name="EncodingError"}}class nd extends Error{constructor(e){super(e),this.name="GVLError"}}class nh extends Error{constructor(e,t,i=""){super(`invalid value ${t} passed for ${e} ${i}`),this.name="TCModelError"}}class np{static DICT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";static REVERSE_DICT=new Map([["A",0],["B",1],["C",2],["D",3],["E",4],["F",5],["G",6],["H",7],["I",8],["J",9],["K",10],["L",11],["M",12],["N",13],["O",14],["P",15],["Q",16],["R",17],["S",18],["T",19],["U",20],["V",21],["W",22],["X",23],["Y",24],["Z",25],["a",26],["b",27],["c",28],["d",29],["e",30],["f",31],["g",32],["h",33],["i",34],["j",35],["k",36],["l",37],["m",38],["n",39],["o",40],["p",41],["q",42],["r",43],["s",44],["t",45],["u",46],["v",47],["w",48],["x",49],["y",50],["z",51],["0",52],["1",53],["2",54],["3",55],["4",56],["5",57],["6",58],["7",59],["8",60],["9",61],["-",62],["_",63]]);static BASIS=6;static LCM=24;static encode(e){if(!/^[0-1]+$/.test(e))throw new nu("Invalid bitField");let t=e.length%this.LCM;e+=t?"0".repeat(this.LCM-t):"";let i="";for(let t=0;t<e.length;t+=this.BASIS)i+=this.DICT[parseInt(e.substr(t,this.BASIS),2)];return i}static decode(e){if(!/^[A-Za-z0-9\-_]+$/.test(e))throw new nl("Invalidly encoded Base64URL string");let t="";for(let i=0;i<e.length;i++){let n=this.REVERSE_DICT.get(e[i]).toString(2);t+="0".repeat(this.BASIS-n.length)+n}return t}}class nf{clone(){let e=new this.constructor,t=Object.keys(this);return t.forEach(t=>{let i=this.deepClone(this[t]);void 0!==i&&(e[t]=i)}),e}deepClone(e){let t=typeof e;if("number"===t||"string"===t||"boolean"===t)return e;if(null!==e&&"object"===t){if("function"==typeof e.clone)return e.clone();if(e instanceof Date)return new Date(e.getTime());if(void 0!==e[Symbol.iterator]){let t=[];for(let i of e)t.push(this.deepClone(i));return e instanceof Array?t:new e.constructor(t)}{let t={};for(let i in e)e.hasOwnProperty(i)&&(t[i]=this.deepClone(e[i]));return t}}}}class ng extends nf{root=null;getRoot(){return this.root}isEmpty(){return!this.root}add(e){let t;let i={value:e,left:null,right:null};if(this.isEmpty())this.root=i;else for(t=this.root;;)if(e<t.value){if(null===t.left){t.left=i;break}t=t.left}else if(e>t.value){if(null===t.right){t.right=i;break}t=t.right}else break}get(){let e=[],t=this.root;for(;t;)if(t.left){let i=t.left;for(;i.right&&i.right!=t;)i=i.right;i.right==t?(i.right=null,e.push(t.value),t=t.right):(i.right=t,t=t.left)}else e.push(t.value),t=t.right;return e}contains(e){let t=!1,i=this.root;for(;i;){if(i.value===e){t=!0;break}e>i.value?i=i.right:e<i.value&&(i=i.left)}return t}min(e=this.root){let t;for(;e;)e.left?e=e.left:(t=e.value,e=null);return t}max(e=this.root){let t;for(;e;)e.right?e=e.right:(t=e.value,e=null);return t}remove(e,t=this.root){let i=null,n="left";for(;t;)if(e<t.value)i=t,t=t.left,n="left";else if(e>t.value)i=t,t=t.right,n="right";else{if(t.left||t.right){if(t.left){if(t.right){let e=this.min(t.right);this.remove(e,t.right),t.value=e}else i?i[n]=t.left:this.root=t.left}else i?i[n]=t.right:this.root=t.right}else i?i[n]=null:this.root=null;t=null}}static build(e){if(!e||0===e.length)return null;if(1===e.length){let t=new ng;return t.add(e[0]),t}{let t=e.length>>1,i=new ng;i.add(e[t]);let n=i.getRoot();if(n){if(t+1<e.length){let i=ng.build(e.slice(t+1));n.right=i?i.getRoot():null}if(t-1>0){let i=ng.build(e.slice(0,t-1));n.left=i?i.getRoot():null}}return i}}}class nv{static langSet=new Set(["BG","CA","CS","DA","DE","EL","EN","ES","ET","FI","FR","HR","HU","IT","JA","LT","LV","MT","NL","NO","PL","PT","RO","RU","SK","SL","SV","TR","ZH"]);has(e){return nv.langSet.has(e)}forEach(e){nv.langSet.forEach(e)}get size(){return nv.langSet.size}}class nm{static cmpId="cmpId";static cmpVersion="cmpVersion";static consentLanguage="consentLanguage";static consentScreen="consentScreen";static created="created";static supportOOB="supportOOB";static isServiceSpecific="isServiceSpecific";static lastUpdated="lastUpdated";static numCustomPurposes="numCustomPurposes";static policyVersion="policyVersion";static publisherCountryCode="publisherCountryCode";static publisherCustomConsents="publisherCustomConsents";static publisherCustomLegitimateInterests="publisherCustomLegitimateInterests";static publisherLegitimateInterests="publisherLegitimateInterests";static publisherConsents="publisherConsents";static publisherRestrictions="publisherRestrictions";static purposeConsents="purposeConsents";static purposeLegitimateInterests="purposeLegitimateInterests";static purposeOneTreatment="purposeOneTreatment";static specialFeatureOptins="specialFeatureOptins";static useNonStandardStacks="useNonStandardStacks";static vendorConsents="vendorConsents";static vendorLegitimateInterests="vendorLegitimateInterests";static vendorListVersion="vendorListVersion";static vendorsAllowed="vendorsAllowed";static vendorsDisclosed="vendorsDisclosed";static version="version"}!function(e){e[e.NOT_ALLOWED=0]="NOT_ALLOWED",e[e.REQUIRE_CONSENT=1]="REQUIRE_CONSENT",e[e.REQUIRE_LI=2]="REQUIRE_LI"}(N||(N={}));class ny extends nf{static hashSeparator="-";purposeId_;restrictionType;constructor(e,t){super(),void 0!==e&&(this.purposeId=e),void 0!==t&&(this.restrictionType=t)}static unHash(e){let t=e.split(this.hashSeparator),i=new ny;if(2!==t.length)throw new nh("hash",e);return i.purposeId=parseInt(t[0],10),i.restrictionType=parseInt(t[1],10),i}get hash(){if(!this.isValid())throw Error("cannot hash invalid PurposeRestriction");return`${this.purposeId}${ny.hashSeparator}${this.restrictionType}`}get purposeId(){return this.purposeId_}set purposeId(e){this.purposeId_=e}isValid(){return Number.isInteger(this.purposeId)&&this.purposeId>0&&(this.restrictionType===N.NOT_ALLOWED||this.restrictionType===N.REQUIRE_CONSENT||this.restrictionType===N.REQUIRE_LI)}isSameAs(e){return this.purposeId===e.purposeId&&this.restrictionType===e.restrictionType}}class nw extends nf{bitLength=0;map=new Map;gvl_;has(e){return this.map.has(e)}isOkToHave(e,t,i){let n=!0;if(this.gvl?.vendors){let o=this.gvl.vendors[i];if(o){if(e===N.NOT_ALLOWED)n=o.legIntPurposes.includes(t)||o.purposes.includes(t);else if(o.flexiblePurposes.length)switch(e){case N.REQUIRE_CONSENT:n=o.flexiblePurposes.includes(t)&&o.legIntPurposes.includes(t);break;case N.REQUIRE_LI:n=o.flexiblePurposes.includes(t)&&o.purposes.includes(t)}else n=!1}else n=!1}return n}add(e,t){if(this.isOkToHave(t.restrictionType,t.purposeId,e)){let i=t.hash;this.has(i)||(this.map.set(i,new ng),this.bitLength=0),this.map.get(i).add(e)}}restrictPurposeToLegalBasis(e){let t=this.gvl.vendorIds,i=e.hash,n=function(){let e;for(e of t);return e}(),o=[...Array(n).keys()].map(e=>e+1);for(let e=1;e<=n;e++)this.has(i)||(this.map.set(i,ng.build(o)),this.bitLength=0),this.map.get(i).add(e)}getVendors(e){let t=[];if(e){let i=e.hash;this.has(i)&&(t=this.map.get(i).get())}else{let e=new Set;this.map.forEach(t=>{t.get().forEach(t=>{e.add(t)})}),t=Array.from(e)}return t}getRestrictionType(e,t){let i;return this.getRestrictions(e).forEach(e=>{e.purposeId===t&&(void 0===i||i>e.restrictionType)&&(i=e.restrictionType)}),i}vendorHasRestriction(e,t){let i=!1,n=this.getRestrictions(e);for(let e=0;e<n.length&&!i;e++)i=t.isSameAs(n[e]);return i}getMaxVendorId(){let e=0;return this.map.forEach(t=>{e=Math.max(t.max(),e)}),e}getRestrictions(e){let t=[];return this.map.forEach((i,n)=>{e?i.contains(e)&&t.push(ny.unHash(n)):t.push(ny.unHash(n))}),t}getPurposes(){let e=new Set;return this.map.forEach((t,i)=>{e.add(ny.unHash(i).purposeId)}),Array.from(e)}remove(e,t){let i=t.hash,n=this.map.get(i);n&&(n.remove(e),n.isEmpty()&&(this.map.delete(i),this.bitLength=0))}set gvl(e){this.gvl_||(this.gvl_=e,this.map.forEach((e,t)=>{let i=ny.unHash(t),n=e.get();n.forEach(t=>{this.isOkToHave(i.restrictionType,i.purposeId,t)||e.remove(t)})}))}get gvl(){return this.gvl_}isEmpty(){return 0===this.map.size}get numRestrictions(){return this.map.size}}!function(e){e.COOKIE="cookie",e.WEB="web",e.APP="app"}(x||(x={})),function(e){e.CORE="core",e.VENDORS_DISCLOSED="vendorsDisclosed",e.VENDORS_ALLOWED="vendorsAllowed",e.PUBLISHER_TC="publisherTC"}(V||(V={}));class nb{static ID_TO_KEY=[V.CORE,V.VENDORS_DISCLOSED,V.VENDORS_ALLOWED,V.PUBLISHER_TC];static KEY_TO_ID={[V.CORE]:0,[V.VENDORS_DISCLOSED]:1,[V.VENDORS_ALLOWED]:2,[V.PUBLISHER_TC]:3}}class nC extends nf{bitLength=0;maxId_=0;set_=new Set;*[Symbol.iterator](){for(let e=1;e<=this.maxId;e++)yield[e,this.has(e)]}values(){return this.set_.values()}get maxId(){return this.maxId_}has(e){return this.set_.has(e)}unset(e){Array.isArray(e)?e.forEach(e=>this.unset(e)):"object"==typeof e?this.unset(Object.keys(e).map(e=>Number(e))):(this.set_.delete(Number(e)),this.bitLength=0,e===this.maxId&&(this.maxId_=0,this.set_.forEach(e=>{this.maxId_=Math.max(this.maxId,e)})))}isIntMap(e){return"object"==typeof e&&Object.keys(e).every(t=>{let i=Number.isInteger(parseInt(t,10));return(i=i&&this.isValidNumber(e[t].id))&&void 0!==e[t].name})}isValidNumber(e){return parseInt(e,10)>0}isSet(e){let t=!1;return e instanceof Set&&(t=Array.from(e).every(this.isValidNumber)),t}set(e){if(Array.isArray(e))e.forEach(e=>this.set(e));else if(this.isSet(e))this.set(Array.from(e));else if(this.isIntMap(e))this.set(Object.keys(e).map(e=>Number(e)));else if(this.isValidNumber(e))this.set_.add(e),this.maxId_=Math.max(this.maxId,e),this.bitLength=0;else throw new nh("set()",e,"must be positive integer array, positive integer, Set<number>, or IntMap")}empty(){this.set_=new Set}forEach(e){for(let t=1;t<=this.maxId;t++)e(this.has(t),t)}get size(){return this.set_.size}setAll(e){this.set(e)}}class nS{static [nm.cmpId]=12;static [nm.cmpVersion]=12;static [nm.consentLanguage]=12;static [nm.consentScreen]=6;static [nm.created]=36;static [nm.isServiceSpecific]=1;static [nm.lastUpdated]=36;static [nm.policyVersion]=6;static [nm.publisherCountryCode]=12;static [nm.publisherLegitimateInterests]=24;static [nm.publisherConsents]=24;static [nm.purposeConsents]=24;static [nm.purposeLegitimateInterests]=24;static [nm.purposeOneTreatment]=1;static [nm.specialFeatureOptins]=12;static [nm.useNonStandardStacks]=1;static [nm.vendorListVersion]=12;static [nm.version]=6;static anyBoolean=1;static encodingType=1;static maxId=16;static numCustomPurposes=6;static numEntries=12;static numRestrictions=12;static purposeId=6;static restrictionType=2;static segmentType=3;static singleOrRange=1;static vendorId=16}class nI{static encode(e){return String(Number(e))}static decode(e){return"1"===e}}class n_{static encode(e,t){let i;if("string"==typeof e&&(e=parseInt(e,10)),(i=e.toString(2)).length>t||e<0)throw new nu(`${e} too large to encode into ${t}`);return i.length<t&&(i="0".repeat(t-i.length)+i),i}static decode(e,t){if(t!==e.length)throw new nl("invalid bit length");return parseInt(e,2)}}class nE{static encode(e,t){return n_.encode(Math.round(e.getTime()/100),t)}static decode(e,t){if(t!==e.length)throw new nl("invalid bit length");let i=new Date;return i.setTime(100*n_.decode(e,t)),i}}class nO{static encode(e,t){let i="";for(let n=1;n<=t;n++)i+=nI.encode(e.has(n));return i}static decode(e,t){if(e.length!==t)throw new nl("bitfield encoding length mismatch");let i=new nC;for(let n=1;n<=t;n++)nI.decode(e[n-1])&&i.set(n);return i.bitLength=e.length,i}}class nk{static encode(e,t){e=e.toUpperCase();let i=e.charCodeAt(0)-65,n=e.charCodeAt(1)-65;if(i<0||i>25||n<0||n>25)throw new nu(`invalid language code: ${e}`);if(t%2==1)throw new nu(`numBits must be even, ${t} is not valid`);t/=2;let o=n_.encode(i,t),s=n_.encode(n,t);return o+s}static decode(e,t){let i;if(t!==e.length||e.length%2)throw new nl("invalid bit length for language");{let t=e.length/2,n=n_.decode(e.slice(0,t),t)+65,o=n_.decode(e.slice(t),t)+65;i=String.fromCharCode(n)+String.fromCharCode(o)}return i}}class nT{static encode(e){let t=n_.encode(e.numRestrictions,nS.numRestrictions);return e.isEmpty()||e.getRestrictions().forEach(i=>{t+=n_.encode(i.purposeId,nS.purposeId)+n_.encode(i.restrictionType,nS.restrictionType);let n=e.getVendors(i),o=n.length,s=0,r=0,a="";for(let t=0;t<o;t++){let i=n[t];0===r&&(s++,r=i);let c=n[o-1],l=e.gvl.vendorIds,u=e=>{for(;++e<=c&&!l.has(e););return e};if(t===o-1||n[t+1]>u(i)){let e=i!==r;a+=nI.encode(e)+n_.encode(r,nS.vendorId),e&&(a+=n_.encode(i,nS.vendorId)),r=0}}t+=n_.encode(s,nS.numEntries)+a}),t}static decode(e){let t=0,i=new nw,n=n_.decode(e.substr(t,nS.numRestrictions),nS.numRestrictions);t+=nS.numRestrictions;for(let o=0;o<n;o++){let n=n_.decode(e.substr(t,nS.purposeId),nS.purposeId);t+=nS.purposeId;let o=n_.decode(e.substr(t,nS.restrictionType),nS.restrictionType);t+=nS.restrictionType;let s=new ny(n,o),r=n_.decode(e.substr(t,nS.numEntries),nS.numEntries);t+=nS.numEntries;for(let n=0;n<r;n++){let n=nI.decode(e.substr(t,nS.anyBoolean));t+=nS.anyBoolean;let o=n_.decode(e.substr(t,nS.vendorId),nS.vendorId);if(t+=nS.vendorId,n){let n=n_.decode(e.substr(t,nS.vendorId),nS.vendorId);if(t+=nS.vendorId,n<o)throw new nl(`Invalid RangeEntry: endVendorId ${n} is less than ${o}`);for(let e=o;e<=n;e++)i.add(e,s)}else i.add(o,s)}}return i.bitLength=t,i}}!function(e){e[e.FIELD=0]="FIELD",e[e.RANGE=1]="RANGE"}(M||(M={}));class nR{static encode(e){let t;let i=[],n=[],o=n_.encode(e.maxId,nS.maxId),s="",r=nS.maxId+nS.encodingType,a=r+e.maxId,c=2*nS.vendorId+nS.singleOrRange+nS.numEntries,l=r+nS.numEntries;return e.forEach((o,r)=>{if(s+=nI.encode(o),(t=e.maxId>c&&l<a)&&o){let t=e.has(r+1);t?0===n.length&&(n.push(r),l+=nS.singleOrRange+nS.vendorId):(n.push(r),l+=nS.vendorId,i.push(n),n=[])}}),t?o+=String(M.RANGE)+this.buildRangeEncoding(i):o+=String(M.FIELD)+s,o}static decode(e,t){let i;let n=0,o=n_.decode(e.substr(n,nS.maxId),nS.maxId);n+=nS.maxId;let s=n_.decode(e.charAt(n),nS.encodingType);if(n+=nS.encodingType,s===M.RANGE){if(i=new nC,1===t){if("1"===e.substr(n,1))throw new nl("Unable to decode default consent=1");n++}let o=n_.decode(e.substr(n,nS.numEntries),nS.numEntries);n+=nS.numEntries;for(let t=0;t<o;t++){let t=nI.decode(e.charAt(n));n+=nS.singleOrRange;let o=n_.decode(e.substr(n,nS.vendorId),nS.vendorId);if(n+=nS.vendorId,t){let t=n_.decode(e.substr(n,nS.vendorId),nS.vendorId);n+=nS.vendorId;for(let e=o;e<=t;e++)i.set(e)}else i.set(o)}}else{let t=e.substr(n,o);n+=o,i=nO.decode(t,o)}return i.bitLength=n,i}static buildRangeEncoding(e){let t=e.length,i=n_.encode(t,nS.numEntries);return e.forEach(e=>{let t=1===e.length;i+=nI.encode(!t)+n_.encode(e[0],nS.vendorId),t||(i+=n_.encode(e[1],nS.vendorId))}),i}}function nA(){return{[nm.version]:n_,[nm.created]:nE,[nm.lastUpdated]:nE,[nm.cmpId]:n_,[nm.cmpVersion]:n_,[nm.consentScreen]:n_,[nm.consentLanguage]:nk,[nm.vendorListVersion]:n_,[nm.policyVersion]:n_,[nm.isServiceSpecific]:nI,[nm.useNonStandardStacks]:nI,[nm.specialFeatureOptins]:nO,[nm.purposeConsents]:nO,[nm.purposeLegitimateInterests]:nO,[nm.purposeOneTreatment]:nI,[nm.publisherCountryCode]:nk,[nm.vendorConsents]:nR,[nm.vendorLegitimateInterests]:nR,[nm.publisherRestrictions]:nT,segmentType:n_,[nm.vendorsDisclosed]:nR,[nm.vendorsAllowed]:nR,[nm.publisherConsents]:nO,[nm.publisherLegitimateInterests]:nO,[nm.numCustomPurposes]:n_,[nm.publisherCustomConsents]:nO,[nm.publisherCustomLegitimateInterests]:nO}}class nL{1={[V.CORE]:[nm.version,nm.created,nm.lastUpdated,nm.cmpId,nm.cmpVersion,nm.consentScreen,nm.consentLanguage,nm.vendorListVersion,nm.purposeConsents,nm.vendorConsents]};2={[V.CORE]:[nm.version,nm.created,nm.lastUpdated,nm.cmpId,nm.cmpVersion,nm.consentScreen,nm.consentLanguage,nm.vendorListVersion,nm.policyVersion,nm.isServiceSpecific,nm.useNonStandardStacks,nm.specialFeatureOptins,nm.purposeConsents,nm.purposeLegitimateInterests,nm.purposeOneTreatment,nm.publisherCountryCode,nm.vendorConsents,nm.vendorLegitimateInterests,nm.publisherRestrictions],[V.PUBLISHER_TC]:[nm.publisherConsents,nm.publisherLegitimateInterests,nm.numCustomPurposes,nm.publisherCustomConsents,nm.publisherCustomLegitimateInterests],[V.VENDORS_ALLOWED]:[nm.vendorsAllowed],[V.VENDORS_DISCLOSED]:[nm.vendorsDisclosed]}}class nP{1=[V.CORE];2=[V.CORE];constructor(e,t){if(2===e.version){if(e.isServiceSpecific)this["2"].push(V.PUBLISHER_TC);else{let i=!!(t&&t.isForVendors);i&&!0!==e[nm.supportOOB]||this["2"].push(V.VENDORS_DISCLOSED),i&&(e[nm.supportOOB]&&e[nm.vendorsAllowed].size>0&&this["2"].push(V.VENDORS_ALLOWED),this["2"].push(V.PUBLISHER_TC))}}}}class nD{static fieldSequence=new nL;static encode(e,t){let i;try{i=this.fieldSequence[String(e.version)][t]}catch(i){throw new nu(`Unable to encode version: ${e.version}, segment: ${t}`)}let n="";t!==V.CORE&&(n=n_.encode(nb.KEY_TO_ID[t],nS.segmentType));let o=nA();return i.forEach(i=>{let s=e[i],r=o[i],a=nS[i];void 0===a&&this.isPublisherCustom(i)&&(a=Number(e[nm.numCustomPurposes]));try{n+=r.encode(s,a)}catch(e){throw new nu(`Error encoding ${t}->${i}: ${e.message}`)}}),np.encode(n)}static decode(e,t,i){let n=np.decode(e),o=0;i===V.CORE&&(t.version=n_.decode(n.substr(o,nS[nm.version]),nS[nm.version])),i!==V.CORE&&(o+=nS.segmentType);let s=this.fieldSequence[String(t.version)][i],r=nA();return s.forEach(e=>{let i=r[e],s=nS[e];if(void 0===s&&this.isPublisherCustom(e)&&(s=Number(t[nm.numCustomPurposes])),0!==s){let r=n.substr(o,s);if(i===nR?t[e]=i.decode(r,t.version):t[e]=i.decode(r,s),Number.isInteger(s))o+=s;else if(Number.isInteger(t[e].bitLength))o+=t[e].bitLength;else throw new nl(e)}}),t}static isPublisherCustom(e){return 0===e.indexOf("publisherCustom")}}class nj{static processor=[e=>e,(e,t)=>{e.publisherRestrictions.gvl=t,e.purposeLegitimateInterests.unset(1);let i=new Map;return i.set("legIntPurposes",e.vendorLegitimateInterests),i.set("purposes",e.vendorConsents),i.forEach((i,n)=>{i.forEach((o,s)=>{if(o){let o=t.vendors[s];if(!o||o.deletedDate)i.unset(s);else if(0===o[n].length){if("legIntPurposes"===n&&0===o.purposes.length&&0===o.legIntPurposes.length&&o.specialPurposes.length>0);else if(e.isServiceSpecific){if(0===o.flexiblePurposes.length)i.unset(s);else{let t=e.publisherRestrictions.getRestrictions(s),o=!1;for(let e=0,i=t.length;e<i&&!o;e++)o=t[e].restrictionType===N.REQUIRE_CONSENT&&"purposes"===n||t[e].restrictionType===N.REQUIRE_LI&&"legIntPurposes"===n;o||i.unset(s)}}else i.unset(s)}}})}),e.vendorsDisclosed.set(t.vendors),e}];static process(e,t){let i=e.gvl;if(!i)throw new nu("Unable to encode TCModel without a GVL");if(!i.isReady)throw new nu("Unable to encode TCModel tcModel.gvl.readyPromise is not resolved");(e=e.clone()).consentLanguage=i.language.toUpperCase(),t?.version>0&&t?.version<=this.processor.length?e.version=t.version:e.version=this.processor.length;let n=e.version-1;if(!this.processor[n])throw new nu(`Invalid version: ${e.version}`);return this.processor[n](e,i)}}class nN{static absCall(e,t,i,n){return new Promise((o,s)=>{let r=new XMLHttpRequest;r.withCredentials=i,r.addEventListener("load",()=>{if(r.readyState==XMLHttpRequest.DONE){if(r.status>=200&&r.status<300){let e=r.response;if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}o(e)}else s(Error(`HTTP Status: ${r.status} response type: ${r.responseType}`))}}),r.addEventListener("error",()=>{s(Error("error"))}),r.addEventListener("abort",()=>{s(Error("aborted"))}),null===t?r.open("GET",e,!0):r.open("POST",e,!0),r.responseType="json",r.timeout=n,r.ontimeout=()=>{s(Error("Timeout "+n+"ms "+e))},r.send(t)})}static post(e,t,i=!1,n=0){return this.absCall(e,JSON.stringify(t),i,n)}static fetch(e,t=!1,i=0){return this.absCall(e,null,t,i)}}class nx extends nf{static LANGUAGE_CACHE=new Map;static CACHE=new Map;static LATEST_CACHE_KEY=0;static DEFAULT_LANGUAGE="EN";static consentLanguages=new nv;static baseUrl_;static set baseUrl(e){if(/^https?:\/\/vendorlist\.consensu\.org\//.test(e))throw new nd("Invalid baseUrl!  You may not pull directly from vendorlist.consensu.org and must provide your own cache");e.length>0&&"/"!==e[e.length-1]&&(e+="/"),this.baseUrl_=e}static get baseUrl(){return this.baseUrl_}static latestFilename="vendor-list.json";static versionedFilename="archives/vendor-list-v[VERSION].json";static languageFilename="purposes-[LANG].json";readyPromise;gvlSpecificationVersion;vendorListVersion;tcfPolicyVersion;lastUpdated;purposes;specialPurposes;features;specialFeatures;isReady_=!1;vendors_;vendorIds;fullVendorList;byPurposeVendorMap;bySpecialPurposeVendorMap;byFeatureVendorMap;bySpecialFeatureVendorMap;stacks;lang_;isLatest=!1;constructor(e){super();let t=nx.baseUrl;if(this.lang_=nx.DEFAULT_LANGUAGE,this.isVendorList(e))this.populate(e),this.readyPromise=Promise.resolve();else{if(!t)throw new nd("must specify GVL.baseUrl before loading GVL json");e>0?nx.CACHE.has(e)?(this.populate(nx.CACHE.get(e)),this.readyPromise=Promise.resolve()):(t+=nx.versionedFilename.replace("[VERSION]",String(e)),this.readyPromise=this.fetchJson(t)):nx.CACHE.has(nx.LATEST_CACHE_KEY)?(this.populate(nx.CACHE.get(nx.LATEST_CACHE_KEY)),this.readyPromise=Promise.resolve()):(this.isLatest=!0,this.readyPromise=this.fetchJson(t+nx.latestFilename))}}static emptyLanguageCache(e){let t=!1;return void 0===e&&nx.LANGUAGE_CACHE.size>0?(nx.LANGUAGE_CACHE=new Map,t=!0):"string"==typeof e&&this.consentLanguages.has(e.toUpperCase())&&(nx.LANGUAGE_CACHE.delete(e.toUpperCase()),t=!0),t}static emptyCache(e){let t=!1;return Number.isInteger(e)&&e>=0?(nx.CACHE.delete(e),t=!0):void 0===e&&(nx.CACHE=new Map,t=!0),t}cacheLanguage(){nx.LANGUAGE_CACHE.has(this.lang_)||nx.LANGUAGE_CACHE.set(this.lang_,{purposes:this.purposes,specialPurposes:this.specialPurposes,features:this.features,specialFeatures:this.specialFeatures,stacks:this.stacks})}async fetchJson(e){try{this.populate(await nN.fetch(e))}catch(e){throw new nd(e.message)}}getJson(){return JSON.parse(JSON.stringify({gvlSpecificationVersion:this.gvlSpecificationVersion,vendorListVersion:this.vendorListVersion,tcfPolicyVersion:this.tcfPolicyVersion,lastUpdated:this.lastUpdated,purposes:this.purposes,specialPurposes:this.specialPurposes,features:this.features,specialFeatures:this.specialFeatures,stacks:this.stacks,vendors:this.fullVendorList}))}async changeLanguage(e){let t=e.toUpperCase();if(nx.consentLanguages.has(t)){if(t!==this.lang_){if(this.lang_=t,nx.LANGUAGE_CACHE.has(t)){let e=nx.LANGUAGE_CACHE.get(t);for(let t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}else{let t=nx.baseUrl+nx.languageFilename.replace("[LANG]",e);try{await this.fetchJson(t),this.cacheLanguage()}catch(e){throw new nd("unable to load language: "+e.message)}}}}else throw new nd(`unsupported language ${e}`)}get language(){return this.lang_}isVendorList(e){return void 0!==e&&void 0!==e.vendors}populate(e){this.purposes=e.purposes,this.specialPurposes=e.specialPurposes,this.features=e.features,this.specialFeatures=e.specialFeatures,this.stacks=e.stacks,this.isVendorList(e)&&(this.gvlSpecificationVersion=e.gvlSpecificationVersion,this.tcfPolicyVersion=e.tcfPolicyVersion,this.vendorListVersion=e.vendorListVersion,this.lastUpdated=e.lastUpdated,"string"==typeof this.lastUpdated&&(this.lastUpdated=new Date(this.lastUpdated)),this.vendors_=e.vendors,this.fullVendorList=e.vendors,this.mapVendors(),this.isReady_=!0,this.isLatest&&nx.CACHE.set(nx.LATEST_CACHE_KEY,this.getJson()),nx.CACHE.has(this.vendorListVersion)||nx.CACHE.set(this.vendorListVersion,this.getJson())),this.cacheLanguage()}mapVendors(e){this.byPurposeVendorMap={},this.bySpecialPurposeVendorMap={},this.byFeatureVendorMap={},this.bySpecialFeatureVendorMap={},Object.keys(this.purposes).forEach(e=>{this.byPurposeVendorMap[e]={legInt:new Set,consent:new Set,flexible:new Set}}),Object.keys(this.specialPurposes).forEach(e=>{this.bySpecialPurposeVendorMap[e]=new Set}),Object.keys(this.features).forEach(e=>{this.byFeatureVendorMap[e]=new Set}),Object.keys(this.specialFeatures).forEach(e=>{this.bySpecialFeatureVendorMap[e]=new Set}),Array.isArray(e)||(e=Object.keys(this.fullVendorList).map(e=>+e)),this.vendorIds=new Set(e),this.vendors_=e.reduce((e,t)=>{let i=this.vendors_[String(t)];return i&&void 0===i.deletedDate&&(i.purposes.forEach(e=>{let i=this.byPurposeVendorMap[String(e)];i.consent.add(t)}),i.specialPurposes.forEach(e=>{this.bySpecialPurposeVendorMap[String(e)].add(t)}),i.legIntPurposes.forEach(e=>{this.byPurposeVendorMap[String(e)].legInt.add(t)}),i.flexiblePurposes&&i.flexiblePurposes.forEach(e=>{this.byPurposeVendorMap[String(e)].flexible.add(t)}),i.features.forEach(e=>{this.byFeatureVendorMap[String(e)].add(t)}),i.specialFeatures.forEach(e=>{this.bySpecialFeatureVendorMap[String(e)].add(t)}),e[t]=i),e},{})}getFilteredVendors(e,t,i,n){let o=e.charAt(0).toUpperCase()+e.slice(1),s={};return("purpose"===e&&i?this["by"+o+"VendorMap"][String(t)][i]:this["by"+(n?"Special":"")+o+"VendorMap"][String(t)]).forEach(e=>{s[String(e)]=this.vendors[String(e)]}),s}getVendorsWithConsentPurpose(e){return this.getFilteredVendors("purpose",e,"consent")}getVendorsWithLegIntPurpose(e){return this.getFilteredVendors("purpose",e,"legInt")}getVendorsWithFlexiblePurpose(e){return this.getFilteredVendors("purpose",e,"flexible")}getVendorsWithSpecialPurpose(e){return this.getFilteredVendors("purpose",e,void 0,!0)}getVendorsWithFeature(e){return this.getFilteredVendors("feature",e)}getVendorsWithSpecialFeature(e){return this.getFilteredVendors("feature",e,void 0,!0)}get vendors(){return this.vendors_}narrowVendorsTo(e){this.mapVendors(e)}get isReady(){return this.isReady_}clone(){let e=new nx(this.getJson());return this.lang_!==nx.DEFAULT_LANGUAGE&&e.changeLanguage(this.lang_),e}static isInstanceOf(e){return"object"==typeof e&&"function"==typeof e.narrowVendorsTo}}class nV extends nf{static consentLanguages=nx.consentLanguages;isServiceSpecific_=!1;supportOOB_=!0;useNonStandardStacks_=!1;purposeOneTreatment_=!1;publisherCountryCode_="AA";version_=2;consentScreen_=0;policyVersion_=2;consentLanguage_="EN";cmpId_=0;cmpVersion_=0;vendorListVersion_=0;numCustomPurposes_=0;gvl_;created;lastUpdated;specialFeatureOptins=new nC;purposeConsents=new nC;purposeLegitimateInterests=new nC;publisherConsents=new nC;publisherLegitimateInterests=new nC;publisherCustomConsents=new nC;publisherCustomLegitimateInterests=new nC;customPurposes;vendorConsents=new nC;vendorLegitimateInterests=new nC;vendorsDisclosed=new nC;vendorsAllowed=new nC;publisherRestrictions=new nw;constructor(e){super(),e&&(this.gvl=e),this.updated()}set gvl(e){nx.isInstanceOf(e)||(e=new nx(e)),this.gvl_=e,this.publisherRestrictions.gvl=e}get gvl(){return this.gvl_}set cmpId(e){if(Number.isInteger(e=Number(e))&&e>1)this.cmpId_=e;else throw new nh("cmpId",e)}get cmpId(){return this.cmpId_}set cmpVersion(e){if(Number.isInteger(e=Number(e))&&e>-1)this.cmpVersion_=e;else throw new nh("cmpVersion",e)}get cmpVersion(){return this.cmpVersion_}set consentScreen(e){if(Number.isInteger(e=Number(e))&&e>-1)this.consentScreen_=e;else throw new nh("consentScreen",e)}get consentScreen(){return this.consentScreen_}set consentLanguage(e){this.consentLanguage_=e}get consentLanguage(){return this.consentLanguage_}set publisherCountryCode(e){if(/^([A-z]){2}$/.test(e))this.publisherCountryCode_=e.toUpperCase();else throw new nh("publisherCountryCode",e)}get publisherCountryCode(){return this.publisherCountryCode_}set vendorListVersion(e){if((e=Number(e)>>0)<0)throw new nh("vendorListVersion",e);this.vendorListVersion_=e}get vendorListVersion(){return this.gvl?this.gvl.vendorListVersion:this.vendorListVersion_}set policyVersion(e){if(this.policyVersion_=parseInt(e,10),this.policyVersion_<0)throw new nh("policyVersion",e)}get policyVersion(){return this.gvl?this.gvl.tcfPolicyVersion:this.policyVersion_}set version(e){this.version_=parseInt(e,10)}get version(){return this.version_}set isServiceSpecific(e){this.isServiceSpecific_=e}get isServiceSpecific(){return this.isServiceSpecific_}set useNonStandardStacks(e){this.useNonStandardStacks_=e}get useNonStandardStacks(){return this.useNonStandardStacks_}set supportOOB(e){this.supportOOB_=e}get supportOOB(){return this.supportOOB_}set purposeOneTreatment(e){this.purposeOneTreatment_=e}get purposeOneTreatment(){return this.purposeOneTreatment_}setAllVendorConsents(){this.vendorConsents.set(this.gvl.vendors)}unsetAllVendorConsents(){this.vendorConsents.empty()}setAllVendorsDisclosed(){this.vendorsDisclosed.set(this.gvl.vendors)}unsetAllVendorsDisclosed(){this.vendorsDisclosed.empty()}setAllVendorsAllowed(){this.vendorsAllowed.set(this.gvl.vendors)}unsetAllVendorsAllowed(){this.vendorsAllowed.empty()}setAllVendorLegitimateInterests(){this.vendorLegitimateInterests.set(this.gvl.vendors)}unsetAllVendorLegitimateInterests(){this.vendorLegitimateInterests.empty()}setAllPurposeConsents(){this.purposeConsents.set(this.gvl.purposes)}unsetAllPurposeConsents(){this.purposeConsents.empty()}setAllPurposeLegitimateInterests(){this.purposeLegitimateInterests.set(this.gvl.purposes)}unsetAllPurposeLegitimateInterests(){this.purposeLegitimateInterests.empty()}setAllSpecialFeatureOptins(){this.specialFeatureOptins.set(this.gvl.specialFeatures)}unsetAllSpecialFeatureOptins(){this.specialFeatureOptins.empty()}setAll(){this.setAllVendorConsents(),this.setAllPurposeLegitimateInterests(),this.setAllSpecialFeatureOptins(),this.setAllPurposeConsents(),this.setAllVendorLegitimateInterests()}unsetAll(){this.unsetAllVendorConsents(),this.unsetAllPurposeLegitimateInterests(),this.unsetAllSpecialFeatureOptins(),this.unsetAllPurposeConsents(),this.unsetAllVendorLegitimateInterests()}get numCustomPurposes(){let e=this.numCustomPurposes_;if("object"==typeof this.customPurposes){let t=Object.keys(this.customPurposes).sort((e,t)=>Number(e)-Number(t));e=parseInt(t.pop(),10)}return e}set numCustomPurposes(e){if(this.numCustomPurposes_=parseInt(e,10),this.numCustomPurposes_<0)throw new nh("numCustomPurposes",e)}updated(){let e=new Date,t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()));this.created=t,this.lastUpdated=t}}class nM{static encode(e,t){let i,n="";return e=nj.process(e,t),(i=Array.isArray(t?.segments)?t.segments:new nP(e,t)[""+e.version]).forEach((t,o)=>{let s="";o<i.length-1&&(s="."),n+=nD.encode(e,t)+s}),n}static decode(e,t){let i=e.split("."),n=i.length;t||(t=new nV);for(let e=0;e<n;e++){let n=i[e],o=np.decode(n.charAt(0)),s=o.substr(0,nS.segmentType),r=nb.ID_TO_KEY[n_.decode(s,nS.segmentType).toString()];nD.decode(n,t,r)}return t}}class nU extends i9{respond(){let e;let t=nt.tcModel,i=t.vendorListVersion;void 0===this.param&&(this.param=i),(e=this.param===i&&t.gvl?t.gvl:new nx(this.param)).readyPromise.then(()=>{this.invokeCallback(e.getJson())})}}class nG extends i7{respond(){this.listenerId=nt.eventQueue.add({callback:this.callback,param:this.param,next:this.next}),super.respond()}}class nF extends i9{respond(){this.invokeCallback(nt.eventQueue.remove(this.param))}}class nW{static [L.PING]=na;static [L.GET_TC_DATA]=i7;static [L.GET_IN_APP_TC_DATA]=nc;static [L.GET_VENDOR_LIST]=nU;static [L.ADD_EVENT_LISTENER]=nG;static [L.REMOVE_EVENT_LISTENER]=nF}class nH{static set_=new Set([0,2,void 0,null]);static has(e){return"string"==typeof e&&(e=Number(e)),this.set_.has(e)}}let nB="__tcfapi";class n${callQueue;customCommands;constructor(e){if(e){let t=L.ADD_EVENT_LISTENER;if(e?.[t])throw Error(`Built-In Custom Commmand for ${t} not allowed: Use ${L.GET_TC_DATA} instead`);if(t=L.REMOVE_EVENT_LISTENER,e?.[t])throw Error(`Built-In Custom Commmand for ${t} not allowed`);e?.[L.GET_TC_DATA]&&(e[L.ADD_EVENT_LISTENER]=e[L.GET_TC_DATA],e[L.REMOVE_EVENT_LISTENER]=e[L.GET_TC_DATA]),this.customCommands=e}try{this.callQueue=window[nB]()||[]}catch(e){this.callQueue=[]}finally{window[nB]=this.apiCall.bind(this),this.purgeQueuedCalls()}}apiCall(e,t,i,...n){if("string"!=typeof e)i(null,!1);else if(nH.has(t)){if("function"!=typeof i)throw Error("invalid callback function");nt.disabled?i(new nn,!1):this.isCustomCommand(e)||this.isBuiltInCommand(e)?this.isCustomCommand(e)&&!this.isBuiltInCommand(e)?this.customCommands[e](i,...n):e===L.PING?this.isCustomCommand(e)?new nW[e](this.customCommands[e],n[0],null,i):new nW[e](i,n[0]):void 0===nt.tcModel?this.callQueue.push([e,t,i,...n]):this.isCustomCommand(e)&&this.isBuiltInCommand(e)?new nW[e](this.customCommands[e],n[0],null,i):new nW[e](i,n[0]):i(null,!1)}else i(null,!1)}purgeQueuedCalls(){let e=this.callQueue;this.callQueue=[],e.forEach(e=>{window[nB](...e)})}isCustomCommand(e){return this.customCommands&&"function"==typeof this.customCommands[e]}isBuiltInCommand(e){return void 0!==nW[e]}}class nq{callResponder;isServiceSpecific;numUpdates=0;constructor(e,t,i=!1,n){this.throwIfInvalidInt(e,"cmpId",2),this.throwIfInvalidInt(t,"cmpVersion",0),nt.cmpId=e,nt.cmpVersion=t,nt.tcfPolicyVersion=2,this.isServiceSpecific=!!i,this.callResponder=new n$(n)}throwIfInvalidInt(e,t,i){if(!("number"==typeof e&&Number.isInteger(e)&&e>=i))throw Error(`Invalid ${t}: ${e}`)}update(e,t=!1){if(nt.disabled)throw Error("CmpApi Disabled");nt.cmpStatus=P.LOADED,t?(nt.displayStatus=D.VISIBLE,nt.eventStatus=j.CMP_UI_SHOWN):void 0===nt.tcModel?(nt.displayStatus=D.DISABLED,nt.eventStatus=j.TC_LOADED):(nt.displayStatus=D.HIDDEN,nt.eventStatus=j.USER_ACTION_COMPLETE),nt.gdprApplies=null!==e,nt.gdprApplies?(""===e?(nt.tcModel=new nV,nt.tcModel.cmpId=nt.cmpId,nt.tcModel.cmpVersion=nt.cmpVersion):nt.tcModel=nM.decode(e),nt.tcModel.isServiceSpecific=this.isServiceSpecific,nt.tcfPolicyVersion=Number(nt.tcModel.policyVersion),nt.tcString=e):nt.tcModel=null,0===this.numUpdates?this.callResponder.purgeQueuedCalls():nt.eventQueue.exec(),this.numUpdates++}disable(){nt.disabled=!0,nt.cmpStatus=P.ERROR}}let nz=class{constructor(e,t){this.window=e,this.logger=t,this.IAB_PURPOSES_COUNT=10,this.TCF_API_VERSION=2,this.CMP_VERSION=5,this.CMP_ID=141,this.initializeTcfApi(),this.consentGiven=new Promise(e=>this.resolveConsent=e),this.readTrackingConsents(),this.subscribe()}initializeTcfApi(){void 0===this.window.__uspapi&&void 0===this.window.__tcfapi&&new nq(this.CMP_ID,this.CMP_VERSION,!0)}subscribe(){this.window.__tcfapi&&this.window.__tcfapi("addEventListener",this.TCF_API_VERSION,this.handleTcfSubscriptionResponse.bind(this))}handleTcfSubscriptionResponse(e){if((null==e?void 0:e.eventStatus)==="useractioncomplete"||(null==e?void 0:e.eventStatus)==="tcloaded"){let t=this.detectTcfTrackingConsent(e);this.consentsUpdated(t),this.window.__tcfapi("removeEventListener",this.TCF_API_VERSION,null,e.listenerId)}}readTrackingConsents(){this.window.__tcfapi&&this.window.__tcfapi("getTCData",this.TCF_API_VERSION,this.handleReadConsentsResponse.bind(this))}handleReadConsentsResponse(e){if((null==e?void 0:e.eventStatus)==="useractioncomplete"||(null==e?void 0:e.eventStatus)==="tcloaded"){let t=this.detectTcfTrackingConsent(e);this.consentsUpdated(t)}}detectTcfTrackingConsent(e){return null!=e&&!!e.purpose&&Object.keys(e.purpose.consents).map(t=>e.purpose.consents[t]).reduce((e,t)=>t+e,0)===this.IAB_PURPOSES_COUNT}consentsUpdated(e){this.logger.info("Consents ready"),this.resolveConsent({gdprConsent:e,geoRequiresConsent:!0,geoRequiresSignal:!1,ccpaSignal:!1})}getTCData(e){return new Promise(t=>{this.window.__tcfapi?this.window.__tcfapi("getTCData",e||this.TCF_API_VERSION,e=>t(e)):t({gdprApplies:!1})})}};nz=tT([ia(),tR(0,is(im)),tR(1,ic(iW,iF,"TCF")),tA("design:paramtypes",["function"==typeof(U="undefined"!=typeof Window&&Window)?U:Object,"function"==typeof(G=void 0!==iW&&iW)?G:Object])],nz);let nQ=class{constructor(e){this.window=e,this.USP_API_VERSION=1,this.CCPA_TRACKING_ALLOWED="1YN",this.queue=[],this.consentGiven=new Promise(e=>this.resolveConsent=e)}installUspApi(){this.window.__uspapi=this.uspApiMessage.bind(this),this.addLocatorFrame(),this.addUspMessageListener()}consentsUpdated(e){this.resolveConsent({gdprConsent:!0,geoRequiresConsent:!1,geoRequiresSignal:!0,ccpaSignal:!e.startsWith(this.CCPA_TRACKING_ALLOWED)})}uspApiMessage(e,t,i){"ping"===e?i({uspapiLoaded:!1},!0):"getQueue"===e?i(this.queue,!0):this.queue.push([e,t,i])}addLocatorFrame(){let e="__uspapi";if(this.window.frames[e])return;if("loading"===document.readyState){document.addEventListener("DOMContentLoaded",()=>this.addLocatorFrame());return}let t=document.createElement("iframe");t.name=e,t.style.display="none",document.body.appendChild(t)}addUspMessageListener(){this.window.addEventListener("message",e=>{let t=this.convertUspMessageData(e);t&&this.uspMessageHandler(t,e)},!1)}convertUspMessageData(e){try{let t="string"==typeof e.data?JSON.parse(e.data):e.data;return t.__uspapiCall}catch(e){}}uspMessageHandler(e,t){this.window.__uspapi(e.command,e.version,(i,n)=>{let o={__uspapiReturn:{returnValue:i,success:n,callId:e.callId}};t.source.postMessage(o,"*")})}subscribe(){this.window.__uspapi&&this.window.__uspapi("addEventListener",this.USP_API_VERSION,this.consentsUpdated.bind(this))}readTrackingConsents(){this.window.__uspapi&&this.window.__uspapi("getUSPData",this.USP_API_VERSION,this.consentsUpdated.bind(this))}};nQ=tT([ia(),tR(0,is(im)),tA("design:paramtypes",["function"==typeof(F="undefined"!=typeof Window&&Window)?F:Object])],nQ);let nY=class{constructor(e,t){this.logger=e,this.geo=t}get(e=!1){let t=this.geo.getCountryCode();if(this.logger.info("Location: ",t),t){if("us"===t)this.logger.info("CCPA location"),this.consentProvider=io.resolve(nQ);else{if(!iH.includes(t))return this.logger.info("Privacy policy is not required"),Promise.resolve({gdprConsent:!0,geoRequiresSignal:!1,geoRequiresConsent:!1,ccpaSignal:!1});this.consentProvider=io.resolve(nz),this.logger.info("__tcfapi installed")}}if(!e)return;let i=io.resolve(i8);this.logger.info("OneTrust installed");let n=[i.consentGiven];return this.consentProvider&&n.push(this.consentProvider.consentGiven),Promise.race(n)}};nY=tT([ia(),tR(0,ic(iW,iF,"OptInService")),tR(1,is(iB)),tA("design:paramtypes",["function"==typeof(W=void 0!==iW&&iW)?W:Object,"function"==typeof(H=void 0!==iB&&iB)?H:Object])],nY);class nK{constructor(e,t){this.__global=!0,this.timestamp=Date.now(),this.name=e.name,this.category=e.category||"[Identity]",this.type=`${this.category} ${e.name}`,Object.assign(this,t)}}var nJ=function(){return(nJ=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},nX={channelId:"default",host:window,coordinatorHost:window.top},nZ={connect:"connect",connected:"connected"},n0="@wikia/post-quecast";function n1(e){var t;return e.channelId&&e.libId===n0&&e.action&&"string"==typeof(t=e.action).type&&"number"==typeof t.timestamp}function n2(e){return!e.data.private}function n6(e,t){return e.data.channelId===t}function n3(e){return e.data.action}var n4=function(){function e(){}return e.make=function(e){var t;return e.host===e.coordinatorHost&&(null===(t=e.coordinatorHost[n0])||void 0===t?void 0:t.callbackConnector)?e.coordinatorHost[n0].callbackConnector:new n8({senderHost:e.coordinatorHost,listenerHost:e.host})},e}(),n5=function(){function e(e){this.coordinatorHost=e,this.callbacks=[]}return e.prototype.dispatch=function(e){var t=this;if(!n1(e))throw Error("Incorrect object type. Expected PostMessageData, but got "+e);this.callbacks.forEach(function(i){return i({data:e,source:t.coordinatorHost})})},e.prototype.addListener=function(e){this.callbacks.push(e)},e.prototype.removeListener=function(e){this.callbacks=this.callbacks.filter(function(t){return t!==e})},e}(),n8=function(){function e(e){this.options=e,this.map=new Map}return e.prototype.dispatch=function(e){if(!n1(e))throw Error("Incorrect object type. Expected PostMessageData, but got "+e);this.options.senderHost.postMessage(e,"*")},e.prototype.addListener=function(e){var t=function(t){t&&t.source&&t.data&&n1(t.data)&&e(t)};this.map.set(e,t),this.options.listenerHost.addEventListener("message",t)},e.prototype.removeListener=function(e){var t=this.map.get(e);this.options.listenerHost.removeEventListener("message",t),this.map.delete(e)},e}(),n9=function(){function e(e){this.callbacks=[],this.history=[],this.channelId=e.channelId,this.connector=n4.make(e),this.setupActions(),this.setupConnection()}return e.prototype.setupActions=function(){this.getHistory(),this.listenEvent()},e.prototype.getHistory=function(){var e=this,t=function(i){if(n6(i,e.channelId)&&i.data.private){var n=n3(i);(function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t.some(function(t){return e.type===t})})(n,nZ.connected)&&(e.connector.removeListener(t),e.handleActions.apply(e,n.history))}};this.connector.addListener(t)},e.prototype.listenEvent=function(){var e=this;this.connector.addListener(function(t){if(n6(t,e.channelId)&&n2(t)){var i=n3(t);e.handleActions(i)}})},e.prototype.handleActions=function(){for(var e,t=this,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];(e=this.history).push.apply(e,i),i.forEach(function(e){return t.callbacks.forEach(function(t){return t(e)})})},e.prototype.setupConnection=function(){this.connector.dispatch({action:{type:nZ.connect,timestamp:Date.now()},channelId:this.channelId,private:!0,libId:n0})},e.prototype.addListener=function(e){this.history.forEach(function(t){return e(t)}),this.callbacks.push(e)},e.prototype.removeListener=function(e){this.callbacks=this.callbacks.filter(function(t){return t!==e})},e}(),n7=function(){function e(e){void 0===e&&(e={});var t=nJ(nJ({},nX),e);this.channelId=t.channelId,this.connector=n4.make(t)}return e.prototype.dispatch=function(e){this.connector.dispatch({action:nJ(nJ({},e),{timestamp:Date.now()}),channelId:this.channelId,private:!0,libId:n0})},e}(),oe=function(){function e(e){void 0===e&&(e={});var t=nJ(nJ({},nX),e);this.transmitter=new n7(t),this.receiver=new n9(t)}return e.prototype.dispatch=function(e){this.transmitter.dispatch(e)},e.prototype.addListener=function(e){this.receiver.addListener(e)},e.prototype.removeListener=function(e){this.receiver.removeListener(e)},e}(),ot=function(){function e(e,t){this.channelId=e,this.connectors=new Map,this.history=[],this.connectors.set(t,t[n0].callbackConnector)}return e.prototype.addConnection=function(e){this.ensureConnector(e).dispatch({action:this.createConnectedAction(),private:!0,channelId:this.channelId,libId:n0})},e.prototype.createConnectedAction=function(){return{type:nZ.connected,history:this.history,timestamp:Date.now()}},e.prototype.broadcast=function(e){var t=this;this.history.push(e),this.connectors.forEach(function(i){i.dispatch({action:e,channelId:t.channelId,libId:n0})})},e.prototype.ensureConnector=function(e){return this.connectors.has(e)||this.connectors.set(e,new n8({senderHost:e,listenerHost:e})),this.connectors.get(e)},e}(),oi=function(){function e(e){this.coordinatorHost=e,this.channels=new Map,this.callbackConnector=new n5(e),this.postMessageConnector=new n8({senderHost:e,listenerHost:e})}return e.prototype.init=function(){var e=this,t=function(t){n2(t)||(e.handleConnect(t),e.handleBroadcast(t))};this.callbackConnector.addListener(t),this.postMessageConnector.addListener(t)},e.prototype.handleConnect=function(e){(function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t.some(function(t){return e.data.action.type===t})})(e,nZ.connect)&&this.ensureChannel(e.data.channelId).addConnection(e.source)},e.prototype.handleBroadcast=function(e){Object.values(nZ).some(function(t){return e.data.action.type===t})||this.ensureChannel(e.data.channelId).broadcast(e.data.action)},e.prototype.ensureChannel=function(e){return this.channels.has(e)||this.channels.set(e,new ot(e,this.coordinatorHost)),this.channels.get(e)},e}();let on=class{constructor(e){this.window=e,this.history=new Map;let{channelId:t,coordinatorName:i}=this.getSettings();(function(e){if(void 0===e&&(e=window),!e[n0]){var t=new oi(e);t.init(),e[n0]=t}})(),this.communicator=new oe({channelId:t||"default",coordinatorHost:e[i]||top})}emit(e){this.communicator.dispatch(e)}on(e,t){this.communicator.addListener(i=>this.run(i,e,t))}once(e,t){this.communicator.addListener(i=>this.runOnce(i,e,t))}getSettings(){return this.window["@wikia/post-quecast-settings"]||{}}run(e,t,i){this.ofType(e,t)&&i(e)}runOnce(e,t,i){let n=t.category+" "+t.name;this.ofType(e,t)&&(this.history.has(n)||(this.history.set(n,!0),i(e)))}ofType(e,t){return e.category===t.category&&e.name===t.name||e.type===t.category+" "+t.name}};on=tT([ia(),tR(0,is(im)),tA("design:paramtypes",["function"==typeof(B="undefined"!=typeof Window&&Window)?B:Object])],on);let oo={CONSENT_READY:{category:"[AdEngine OptIn]",name:"set opt in"},IDENTITY_READY:{category:"[IdentityEngine]",name:"Identity ready"},IDENTITY_PARTNER_DATA_OBTAINED:{category:"[AdEngine]",name:"Identity partner data obtained"},AGE_GATE_DATA:{name:"Age gate result",category:"[Identity]"}};var os={};function or(e,t){return Object.keys(t).forEach(function(i){"default"===i||"__esModule"===i||e.hasOwnProperty(i)||Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[i]}})}),e}function oa(e,t,i,n){Object.defineProperty(e,t,{get:i,set:n,enumerable:!0,configurable:!0})}oa(os,"utils",()=>oc);var oc={},ol={};function ou(e){return new Promise(t=>setTimeout(()=>t(),e))}oa(ol,"delay",()=>ou);var od={};function oh(){let e=new URLSearchParams(window.location.search.substring(1));return e.get("adengine_debug")?e.get("adengine_debug"):e.get("identity_debug")}oa(od,"getDebugGroup",()=>oh);var op={};oa(op,"localStorageHelper",()=>of);class of{constructor(e,t=6e4){this.key=e,this.ttlInMilliseconds=t;let i=!1;try{(i=void 0!==window.localStorage&&null!==window.localStorage)&&(window.localStorage.setItem("__test__","test"),window.localStorage.removeItem("__test__"))}catch(e){i=!1}let n={getItem:e=>window?.instantConfigCache?.[e]??null,setItem:(e,t)=>{void 0===window.instantConfigCache&&(window.instantConfigCache={}),window.instantConfigCache[e]=t}};this.storageAdapter={getItem:e=>{try{if(i)return window.localStorage.getItem(e)??n.getItem(e);return n.getItem(e)}catch(t){return n.getItem(e)}},setItem:(e,t)=>{try{if(i)return localStorage.setItem(e,t);n.setItem(e,t)}catch(i){n.setItem(e,t)}}}}set(e){let t=this.getObjectToStore(e);this.storageAdapter.setItem(this.key,JSON.stringify(t))}get(){let e=this.storageAdapter.getItem(this.key);return e?this.parseStoredValue(JSON.parse(e)):null}expired(e){return!e||e<Date.now()}getObjectToStore(e){return{data:e,ttl:Date.now()+this.ttlInMilliseconds}}parseStoredValue(e){return this.expired(e?.ttl)?null:e.data}}var og={};oa(og,"lock",()=>om),oa(og,"release",()=>oy);let ov=new of("instant-config-lock",1e3);function om(){return"lock"===ov.get()||(ov.set("lock"),!1)}function oy(){ov.set(null)}var ow={};oa(ow,"getTimeDelta",()=>oI),oa(ow,"logger",()=>o_),oa(ow,"warner",()=>oE);let ob=oh()||"",oC=ob.split(","),oS=Date.now();function oI(){let e=Date.now(),t=window.performance?.timeOrigin??oS;return((e-t)/1e3).toFixed(4)}function o_(e,...t){""!==ob&&("1"===ob||-1!==oC.indexOf(e))&&window.console.info(`${oI()}s		 ${e}`,t)}function oE(e,...t){""!==ob&&("1"===ob||-1!==oC.indexOf(e))&&window.console.warn(e,t)}or(oc,ol),or(oc,od),or(oc,op),or(oc,og),or(oc,ow);var oO={},ok={};oa(ok,"EmptyInstantConfigCacheStorage",()=>oT);class oT{get(e){}set(e){}}var oR={};oa(oR,"InstantConfigInterpreter",()=>oX);var oA={},oL={};oa(oL,"BrowserMatcher",()=>oH);var oP={};oa(oP,"extractNegation",()=>oW);var oD={},oj={};function oN(e){return Array.isArray(e)&&e.length>0&&"object"==typeof e[0]}oa(oj,"shouldBeListOfConfigGroups",()=>oN);var ox={};oa(ox,"negativePrefix",()=>oV),oa(ox,"cacheSuffix",()=>oM),oa(ox,"samplingSeparator",()=>oU),oa(ox,"worldWide",()=>oG),oa(ox,"precision",()=>oF);let oV="non-",oM="-cached",oU="/",oG="XX",oF=1e6;function oW(e){return e.startsWith(oV)?{value:e.replace(oV,""),negated:!0}:{value:e,negated:!1}}or(oD,{}),or(oD,{}),or(oD,{}),or(oD,oj),or(oD,{}),or(oD,{}),or(oD,{}),or(oD,{}),or(oD,{}),or(oD,ox);class oH{constructor(e){this.currentBrowser=e?.toLowerCase()}isValid(e=[]){let t=e.map(e=>e.toLowerCase()).map(e=>oW(e));return 0===e.length||!this.currentBrowser||!this.isCurrentNegated(this.currentBrowser,t)&&t.some(e=>this.currentBrowser.includes(e.value)!==e.negated)}isCurrentNegated(e,t){return t.some(t=>e.includes(t.value)&&t.negated)}}var oB={};oa(oB,"DeviceMatcher",()=>o$);class o${constructor(e){this.currentDevice=e}isValid(e=[]){let t=e.map(e=>e.toLowerCase()).map(e=>oW(e));return 0===t.length||!this.currentDevice||!this.isCurrentNegated(this.currentDevice,t)&&t.some(e=>e.value===this.currentDevice!==e.negated)}isCurrentNegated(e,t){return t.some(t=>e.includes(t.value)&&t.negated)}}var oq={};oa(oq,"DomainMatcher",()=>oz);class oz{isValid(e=[]){return 0===e.length||e.some(e=>window.location.hostname.includes(e))}}var oQ={};oa(oQ,"RegionMatcher",()=>oY);class oY{constructor(e){this.geo=e}isValid(e=[],t){let i=this.filterOutInvalidRegions(e);return t?t(i):this.isProperGeo(i)}getCountryCode(){return this.geo?.country}getRegionCode(){return this.geo?.region}getContinentCode(){return this.geo?.continent}isProperGeo(e=[]){return!!(e&&e.indexOf&&!this.isGeoExcluded(e)&&(this.isProperContinent(e)||this.isProperCountry(e)||this.isProperRegion(e)))}filterOutInvalidRegions(e){return e.filter(e=>!e.includes(oU)).filter(e=>!e.includes(oM))}isProperCountry(e){return!!(e&&e.indexOf&&(e.indexOf(this.getCountryCode())>-1||this.isSampledForGeo(e,this.getCountryCode())))}isProperRegion(e){let t=`${this.getCountryCode()}-${this.getRegionCode()}`;return!!(e&&e.indexOf&&(e.indexOf(t)>-1||this.isSampledForGeo(e,t)))}containsContinent(e){let t=`${oG}-${this.getContinentCode()}`;return e.indexOf(t)>-1||this.isSampledForGeo(e,t)}containsWorldWide(e){return e.indexOf(oG)>-1||this.isSampledForGeo(e,oG)}isProperContinent(e){return!!(e&&e.indexOf&&(this.containsWorldWide(e)||this.containsContinent(e)))}isGeoExcluded(e){return!!(e.indexOf(`${oV}${this.getCountryCode()}`)>-1||e.indexOf(`${oV}${this.getCountryCode()}-${this.getRegionCode()}`)>-1||e.indexOf(`${oV}${oG}-${this.getContinentCode()}`)>-1)}hasSampling(e){return t=>0!==t.indexOf(oV)&&t.indexOf(e+oU)>-1}getSamplingLimits(e){let[,t]=e.split(oU);return Math.round(parseFloat(t=t.replace(oM,""))*oF)||0}isSampledForGeo(e,t){let i=e.filter(this.hasSampling(t));if(0===i.length)return!1;let n=Math.round(Math.random()*(100*oF))||0;return i.map(e=>this.getSamplingLimits(e)).some(e=>n<e)}}var oK={};oa(oK,"SamplingCacheManager",()=>oJ);class oJ{constructor(e){this.cacheStorage=e,this.precision=1e6}apply(e,t,i){let n=this.cacheStorage.get(e);if(void 0!==n)return n.result;let o=i();if("number"!=typeof t.sampling||!1===o)return o;let s=this.getSamplingResult(t.sampling),r={name:e,result:s,withCookie:!!t.samplingCache,group:s?"B":"A",limit:+(s?t.sampling:100-t.sampling).toFixed(6)};return this.cacheStorage.set(r),s}getSamplingResult(e){let t=Math.round(100*Math.random()*this.precision),i=Math.round(e*this.precision);return i>t}}or(oA,oL),or(oA,oB),or(oA,oq),or(oA,oP),or(oA,oQ),or(oA,oK);class oX{constructor(e=new oH,t=new o$,i=new oz,n=new oY,o=new oT){this.browserMatcher=e,this.deviceMatcher=t,this.domainMatcher=i,this.regionMatcher=n,this.instantConfigCacheService=o,this.logGroup="instant-config-interpreter",this.configResponse={},this.samplingCache=new oJ(o)}init(e,t={},i){return this.configResponse={...t,...e},this.regionValidationPredicate=i,this}getValues(){return oc.logger(this.logGroup,"get values called with",this.configResponse),Object.keys(this.configResponse).map(e=>({key:e,value:this.configResponse[e]})).map(({key:e,value:t})=>oN(t)?{key:e,value:this.getValue(e,t)}:{key:e,value:t}).reduce((e,t)=>({...e,[t.key]:t.value}),{})}getValue(e,t){let i=t.find((t,i)=>this.samplingCache.apply(`${e}-${i}`,t,this.getPredicate(t)));if(void 0!==i)return i.value}getPredicate(e){return()=>this.browserMatcher.isValid(e.browsers)&&this.deviceMatcher.isValid(e.devices)&&this.domainMatcher.isValid(e.domains)&&this.regionMatcher.isValid(e.regions,this.regionValidationPredicate)}}var oZ={};async function o0(e,t=2e3){let i=new AbortController,n=setTimeout(()=>i.abort(),t),o=await fetch(e,{signal:i.signal});return clearTimeout(n),o}oa(oZ,"InstantConfigLoader",()=>o3);let o1="instant-config-loader",o2="instantConfig",o6={b:"browsers",d:"devices",s:"sampling",c:"samplingCache",r:"regions",v:"value"};class o3{constructor(e,t=window){this.params=e,this.configPromise=null,this.storage=new oc.localStorageHelper(`instant-config-${e.appName}`,6e4),this.instantConfig=this.fromContainer(t)}async getConfig(){return this.instantConfig?this.instantConfig:(this.configPromise||(this.configPromise=this.fetchInstantConfig().then(e=>e??this.fetchFallbackConfig())),this.configPromise.then(e=>e))}async fetchInstantConfig(e=!1){let t=oc.lock();if(t&&!e)return await ou(500),this.fetchInstantConfig(!0);let i=this.params.instantConfigEndpoint??"https://services.fandom.com",n=this.params.instantConfigVariant??"icbm",o=this.params.appName,s=`${i}/${n}/api/config?app=${o}`;try{let e=this.storage.get();if(e)return oc.logger(o1,"instant config pulled from local storage",e),JSON.parse(e);let t=await o0(s,this.params.requestTimeout);if(!t.ok)return;let i=await t.json();return this.storage.set(JSON.stringify(i)),oc.release(),oc.logger(o1,"instant config fetched",i),i}catch(e){oc.warner(o1,"could not fetch instant config",e),oc.release();return}}async fetchFallbackConfig(){oc.logger(o1,"Fetching fallback config");let e=this.params.instantConfigFallbackEndpoint;if(void 0===e)return{};try{oc.logger(o1,e);let t=await o0(e,this.params.requestTimeout);if(!t.ok)return{};let i=await t.json();return oc.logger(o1,"fallback config fetched",i),i}catch(e){return oc.warner(o1,"could not fetch fallback config",e),{}}}fromContainer(e){let t=e[o2];return"object"!=typeof t||t._ready||(Object.keys(t).forEach(e=>{let i=t[e];oN(i)&&(t[e]=i.map(e=>Object.fromEntries(Object.entries(e).map(([e,t])=>[o6[e]?o6[e]:e,t]))))}),t._ready=!0,e[o2]=t),t}}var o4={};oa(o4,"InstantConfigOverrider",()=>o8);let o5=["InstantGlobals","icbm"];class o8{override(e,t){return[...e.keys()].filter(e=>o5.some(t=>e.startsWith(`${t}.`)||e.startsWith(`${t}__`))).map(e=>{let[,t]=e.split(".").map(e=>e.split("__")).flat();return{paramKey:e,key:t}}).map(({paramKey:t,key:i})=>({key:i,value:this.parseValue(e.get(t))})).reduce((e,{key:t,value:i})=>({...e,[t]:i}),t)}parseValue(e){if("true"===e||"false"===e)return"true"===e;let t=parseInt(e,10);if(e===`${t}`)return t;try{return JSON.parse(e)}catch(t){return e||null}}}or(oO,ok),or(oO,oR),or(oO,oZ),or(oO,o4),or(oO,oA),or(os,oO),or(os,oD);let o9=class{constructor(e,t,i,n,o){this.device=e,this.browser=t,this.platform=i,this.geo=n,this.logger=o}init(e={}){return tL(this,void 0,void 0,function*(){let t=this.platform.get(),i=this.geo.get(),n=new os.InstantConfigLoader({appName:t}),o=new os.InstantConfigInterpreter(new os.BrowserMatcher(this.browser.getBrowser()),new os.DeviceMatcher(this.device.getDeviceType()),new os.DomainMatcher,new os.RegionMatcher(i)),s=yield n.getConfig();s=new(0,os.InstantConfigOverrider)().override(iG.getURLSearchParams(),s);let r=o.init(s,e);return this.repository=r.getValues(),this.logger.info("instantiated with",this.repository),this})}get(e,t){return e in this.repository&&void 0!==this.repository[e]?this.repository[e]:t}};o9=tT([ia(),tR(0,is(iU)),tR(1,is(iC)),tR(2,is(iQ)),tR(3,is(iB)),tR(4,ic(iW,iF,"InstantConfig")),tA("design:paramtypes",["function"==typeof($=void 0!==iU&&iU)?$:Object,"function"==typeof(q=void 0!==iC&&iC)?q:Object,"function"==typeof(z=void 0!==iQ&&iQ)?z:Object,"function"==typeof(Q=void 0!==iB&&iB)?Q:Object,"function"==typeof(Y=void 0!==iW&&iW)?Y:Object])],o9);let o7=class{get trackingAllowed(){return this._trackingAllowed}set trackingAllowed(e){this._trackingAllowed=e}constructor(e,t,i,n){this.communicationService=e,this.consentProviderFactory=t,this.logger=i,this.instantConfigService=n,this._trackingAllowed=!1}init(){var e;let t=this.instantConfigService.get("icFandom1TEnabled",!1);this.consentProvider=this.consentProviderFactory.get(t),null===(e=this.consentProvider)||void 0===e||e.then(e=>{this.logger.info("Sending consents: ",e),this.sendConsentsToAdEngine(e)})}sendConsentsToAdEngine(e){this.communicationService.emit(new nK(oo.CONSENT_READY,e))}};o7=tT([ia(),tR(0,is(on)),tR(1,is(nY)),tR(2,ic(iW,iF,"OptInService")),tR(3,is(o9)),tA("design:paramtypes",["function"==typeof(K=void 0!==on&&on)?K:Object,"function"==typeof(J=void 0!==nY&&nY)?J:Object,"function"==typeof(X=void 0!==iW&&iW)?X:Object,"function"==typeof(Z=void 0!==o9&&o9)?Z:Object])],o7);let se=class{constructor(e,t,i,n,o,s,r){this.logger=e,this.httpClient=t,this.skin=i,this.optInService=n,this.window=o,this.wikiConfig=s,this.geo=r,this.dataWarehouseUrl="https://beacon.wikia-services.com/__track/special/identityinfo",this.initStartTime()}getTimeOrigin(){var e;return null===(e=window.performance)||void 0===e?void 0:e.timeOrigin}initStartTime(){let e=new Date;this.startTime||(this.startTime=this.getTimeOrigin(),this.tzOffset=e.getTimezoneOffset())}getCurrentTimestamp(){return Date.now()}getStartTime(){return this.startTime}getTimezoneOffset(){return this.tzOffset}send(e){this.sendEvent(e,this.dataWarehouseUrl)}sendEvent(e,t){let i=Object.assign(Object.assign(Object.assign({},e),this.getTimeBasedParams()),this.getTrackingParams()),n=this.buildDataWarehouseUrl(i,t);n&&this.httpClient.get(n)}getTrackingParams(){var e,t,i,n,o,s,r,a,c,l,u,d,h;return{browser_ts:this.getCurrentTimestamp(),tz_offset:this.getTimezoneOffset(),country:this.geo.getCountryCode()||"",session_id:null===(t=null===(e=this.window.fandomContext)||void 0===e?void 0:e.tracking)||void 0===t?void 0:t.sessionId,pv_number:null===(n=null===(i=this.window.fandomContext)||void 0===i?void 0:i.tracking)||void 0===n?void 0:n.pvNumber,pv_number_global:null===(s=null===(o=this.window.fandomContext)||void 0===o?void 0:o.tracking)||void 0===s?void 0:s.pvNumberGlobal,pv_unique_id:null===(a=null===(r=this.window.fandomContext)||void 0===r?void 0:r.tracking)||void 0===a?void 0:a.pvUID,beacon:null===(l=null===(c=this.window.fandomContext)||void 0===c?void 0:c.tracking)||void 0===l?void 0:l.beaconId,ua:null===(u=this.window.navigator)||void 0===u?void 0:u.userAgent,c:this.wikiConfig.get("wgCityId")||"unknown",ck:this.wikiConfig.get("dsSiteKey")||"unknown",lc:this.wikiConfig.get("wgUserLanguage")||"unknown",s:this.skin.get(),u:this.optInService.trackingAllowed?this.wikiConfig.get("wgUserId")||0:-1,a:(null===(h=null===(d=this.window.fandomContext)||void 0===d?void 0:d.page)||void 0===h?void 0:h.articleId)||-1,x:this.wikiConfig.get("wgDBname")||"unknown",n:this.wikiConfig.get("wgNamespaceNumber")||-1}}getTimeBasedParams(){return{cb:Math.floor(99999*Math.random()),url:document.URL}}buildDataWarehouseUrl(e,t){if(!t){this.logger.error("Error building DWH tracking URL");return}let i=new URLSearchParams(e);return i.sort(),`${t}?${i.toString()}`}};se=tT([ir(),tR(0,ic(iW,iF,"DataWarehouseService")),tR(1,is(i$)),tR(2,is(iY)),tR(3,is(o7)),tR(4,is(im)),tR(5,is(iZ)),tR(6,is(iB)),tA("design:paramtypes",["function"==typeof(ee=void 0!==iW&&iW)?ee:Object,"function"==typeof(et=void 0!==i$&&i$)?et:Object,"function"==typeof(ei=void 0!==iY&&iY)?ei:Object,"function"==typeof(en=void 0!==o7&&o7)?en:Object,"function"==typeof(eo="undefined"!=typeof Window&&Window)?eo:Object,"function"==typeof(es=void 0!==iZ&&iZ)?es:Object,"function"==typeof(er=void 0!==iB&&iB)?er:Object])],se),function(e){e[e.identity=0]="identity",e[e.loadTime=1]="loadTime"}(ea||(ea={}));let st=class{constructor(e,t,i,n,o,s){this.logger=e,this.httpClient=t,this.skin=i,this.window=n,this.wikiConfig=o,this.geo=s,this.dataWarehouseUrl="https://beacon.wikia-services.com/__track/special/adengloadtimes",this.initStartTime()}getTimeOrigin(){var e;return null===(e=window.performance)||void 0===e?void 0:e.timeOrigin}getCurrentTimestamp(){return Date.now()}initStartTime(){let e=new Date;this.startTime||(this.startTime=this.getTimeOrigin(),this.tzOffset=e.getTimezoneOffset())}getStartTime(){return this.startTime}getTimezoneOffset(){return this.tzOffset}send(e){this.sendEvent(e,this.dataWarehouseUrl)}sendEvent(e,t){let i=Object.assign(Object.assign({event_name:e,load_time:this.getCurrentTimestamp()-this.getStartTime()},this.getTimeBasedParams()),this.getTrackingParams()),n=this.buildDataWarehouseUrl(i,t);n&&this.httpClient.get(n)}getTrackingParams(){var e,t,i,n,o,s,r,a,c,l,u,d,h;return{browser_ts:this.getCurrentTimestamp(),tz_offset:this.getTimezoneOffset(),country:this.geo.getCountryCode()||"",session_id:null===(t=null===(e=this.window.fandomContext)||void 0===e?void 0:e.tracking)||void 0===t?void 0:t.sessionId,pv_number:null===(n=null===(i=this.window.fandomContext)||void 0===i?void 0:i.tracking)||void 0===n?void 0:n.pvNumber,pv_number_global:null===(s=null===(o=this.window.fandomContext)||void 0===o?void 0:o.tracking)||void 0===s?void 0:s.pvNumberGlobal,pv_unique_id:null===(a=null===(r=this.window.fandomContext)||void 0===r?void 0:r.tracking)||void 0===a?void 0:a.pvUID,beacon:null===(l=null===(c=this.window.fandomContext)||void 0===c?void 0:c.tracking)||void 0===l?void 0:l.beaconId,u:-1,ua:null===(u=this.window.navigator)||void 0===u?void 0:u.userAgent,c:this.wikiConfig.get("wgCityId")||"unknown",ck:this.wikiConfig.get("dsSiteKey")||"unknown",lc:this.wikiConfig.get("wgUserLanguage")||"unknown",s:this.skin.get(),a:(null===(h=null===(d=this.window.fandomContext)||void 0===d?void 0:d.page)||void 0===h?void 0:h.articleId)||-1,x:this.wikiConfig.get("wgDBname")||"unknown",n:this.wikiConfig.get("wgNamespaceNumber")||-1}}getTimeBasedParams(){return{cb:Math.floor(99999*Math.random()),url:document.URL}}buildDataWarehouseUrl(e,t){if(!t){this.logger.error("Error building DWH tracking URL");return}let i=new URLSearchParams(e);return i.sort(),`${t}?${i.toString()}`}};st=tT([ir(),tR(0,ic(iW,iF,"DataWarehouseService")),tR(1,is(i$)),tR(2,is(iY)),tR(3,is(im)),tR(4,is(iZ)),tR(5,is(iB)),tA("design:paramtypes",["function"==typeof(ec=void 0!==iW&&iW)?ec:Object,"function"==typeof(el=void 0!==i$&&i$)?el:Object,"function"==typeof(eu=void 0!==iY&&iY)?eu:Object,"function"==typeof(ed="undefined"!=typeof Window&&Window)?ed:Object,"function"==typeof(eh=void 0!==iZ&&iZ)?eh:Object,"function"==typeof(ep=void 0!==iB&&iB)?ep:Object])],st);let si=class{constructor(e,t,i){this.logger=e,this.identityEventSender=t,this.loadTimeEventSender=i}track(e,t){switch(e){case ea.identity:this.identityEventSender.send(t);break;case ea.loadTime:this.loadTimeEventSender.send(t);break;default:this.logger.info("Invalid event type to track")}}};si=tT([ir(),tR(0,ic(iW,iF,"DataWarehouseService")),tR(1,is(se)),tR(2,is(st)),tA("design:paramtypes",["function"==typeof(ef=void 0!==iW&&iW)?ef:Object,"function"==typeof(eg=void 0!==se&&se)?eg:Object,"function"==typeof(ev=void 0!==st&&st)?ev:Object])],si);let sn=class{constructor(e){this.cookiesManager=e}get(e){return this.cookiesManager.get(e)}set(e,t){let{value:i,domain:n,expiresMS:o}=t,s=new Date(new Date().getTime()+o);this.cookiesManager.set(e,i.toString(),{domain:n,expires:s})}remove(e){this.cookiesManager.remove(e)}};sn=tT([ir(),tR(0,is(iv)),tA("design:paramtypes",["function"==typeof(em="undefined"!=typeof CookiesManager&&CookiesManager)?em:Object])],sn);let so=class{constructor(e){this.window=e}get(e){return this.window.fandomContext.tracking[e]}set(e,t){this.window.fandomContext&&this.window.fandomContext.tracking||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{tracking:{}})),this.window.fandomContext.tracking[e]=t.value}remove(e){try{delete this.window.fandomContext.tracking[e]}catch(e){}}};so=tT([ir(),tR(0,is(im)),tA("design:paramtypes",["function"==typeof(ey="undefined"!=typeof Window&&Window)?ey:Object])],so);let ss=class{constructor(e){this.cookiesManager=e}getNextNumberFromCookie(e){let t=parseInt(this.cookiesManager.get(e));return Number.isNaN(t)?1:t+1}};ss=tT([ir(),tR(0,is(iv)),tA("design:paramtypes",["function"==typeof(ew="undefined"!=typeof CookiesManager&&CookiesManager)?ew:Object])],ss);let sr=class{constructor(e,t,i,n,o,s,r){this.windowRepository=e,this.cookieRepository=t,this.uuid=i,this.beaconGenerator=n,this.pageViewNumberGenerator=o,this.window=s,this.wikiConfig=r}set(e,t){this.windowRepository.set(e,t),this.cookieRepository.set(e,t)}remove(e){this.windowRepository.remove(e),this.cookieRepository.remove(e)}setup(e){let t=iX.extract(e);this.windowRepository.set("pvUID",{domain:e,expiresMS:18e5,value:this.wikiConfig.get("pvUID")||this.window.pvUID||this.uuid()});let i=this.cookieRepository.get("wikia_beacon_id")||this.cookieRepository.get("beaconId"),n={domain:t,expiresMS:15552e6,value:i||this.beaconGenerator.generate()};this.windowRepository.set("beaconId",n),this.cookieRepository.set("wikia_beacon_id",n);let o=this.wikiConfig.get("sessionId",this.window.sessionId),s=o||this.cookieRepository.get("sessionId"),r={domain:t,expiresMS:18e5,value:s||this.uuid()};this.set("sessionId",r),this.set("pvNumber",{domain:e,expiresMS:18e5,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumber")}),this.set("pvNumberGlobal",{domain:t,expiresMS:18e5,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumberGlobal")})}clear(){this.remove("beaconId"),this.remove("sessionId"),this.remove("pvNumber"),this.remove("pvNumberGlobal")}};sr=tT([ia(),tR(0,is(so)),tR(1,is(sn)),tR(2,is(iy)),tR(3,is(i2)),tR(4,is(ss)),tR(5,is(im)),tR(6,is(iZ)),tA("design:paramtypes",["function"==typeof(eb=void 0!==so&&so)?eb:Object,"function"==typeof(eC=void 0!==sn&&sn)?eC:Object,Function,"function"==typeof(eS=void 0!==i2&&i2)?eS:Object,"function"==typeof(eI=void 0!==ss&&ss)?eI:Object,"function"==typeof(e_="undefined"!=typeof Window&&Window)?e_:Object,"function"==typeof(eE=void 0!==iZ&&iZ)?eE:Object])],sr);let sa=class{constructor(e,t,i,n){this.window=e,this.logger=t,this.context=i,this.cookieRepository=n,this.createPartnersContext()}createPartnersContext(){this.window.fandomContext&&this.window.fandomContext.partners||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{partners:{}}))}setIsCoppaSubjectInContext(e){this.coppaSubject=e,this.window.fandomContext.partners.directedAtChildren=e,this.window.fandomContext.partners.blockthrough={directedAtChildren:e}}isCoppaSubject(){return void 0===this.coppaSubject?this.resolveCoppaStatus():this.coppaSubject}resolveCoppaStatus(){var e,t;let i=!!(null===(t=null===(e=this.context.get())||void 0===e?void 0:e.targeting)||void 0===t?void 0:t.directedAtChildren);if(!i)return this.setIsCoppaSubjectInContext(!1),!1;try{let e=this.cookieRepository.get("ag"),t="1"!==e;return this.setIsCoppaSubjectInContext(t),t}catch(e){this.logger.error("Error while reading age gate cookie")}}};sa=tT([ia(),tR(0,is(im)),tR(1,ic(iW,iF,"CoppaSubject")),tR(2,is(ib)),tR(3,is(sn)),tA("design:paramtypes",["function"==typeof(eO="undefined"!=typeof Window&&Window)?eO:Object,"function"==typeof(ek=void 0!==iW&&iW)?ek:Object,"function"==typeof(eT=void 0!==ib&&ib)?eT:Object,"function"==typeof(eR=void 0!==sn&&sn)?eR:Object])],sa);let sc=class{constructor(e,t,i){this.dataWarehouse=e,this.window=t,this.logger=i}activateTracking(){if(!this.isEnabled()){this.logger.info("Hem Tracking is disabled");return}let e=this.extractHEMs();Object.keys(e).forEach(t=>{e[t]&&this.dataWarehouse.track(ea.identity,{partner_name:"MediaWiki-"+t,partner_identity_id:e[t]})})}isEnabled(){var e,t,i;return(null===(i=null===(t=null===(e=this.window.ads)||void 0===e?void 0:e.context)||void 0===t?void 0:t.opts)||void 0===i?void 0:i.userEmailHashes)&&this.window.ads.context.opts.userEmailHashes.length>0}extractHEMs(){let[e,t,i]=this.window.ads.context.opts.userEmailHashes;return{md5:e,sha1:t,sha256:i}}};sc=tT([ir(),tR(0,is(si)),tR(1,is(im)),tR(2,ic(iW,iF,"HemTracking")),tA("design:paramtypes",["function"==typeof(eA=void 0!==si&&si)?eA:Object,"function"==typeof(eL="undefined"!=typeof Window&&Window)?eL:Object,"function"==typeof(eP=void 0!==iW&&iW)?eP:Object])],sc);let sl=class{constructor(e,t,i,n){this.platform=t,this.window=i,this.logger=n,this.enabled=!1,this.endpoint=`${e.get()}adeng/api/identity/metrics`}init(e){var t;let i=e.get("icMonitorTrafficThreshold",{identity:0});this.enabled=!!("object"==typeof i&&!Array.isArray(i)&&null!==i)&&(null==i?void 0:i.identity)>0&&i.identity>=100*Math.random(),this.logger.info(`Metric reporter enabled: ${this.enabled}, threshold:`,i),this.enabled&&("complete"===this.window.document.readyState?this.sendPerformanceMetrics():null===(t=this.window)||void 0===t||t.addEventListener("load",()=>this.sendPerformanceMetrics()))}send(e,t=0){if(!this.enabled)return;let i=new URL(this.endpoint);i.searchParams.set("app",this.platform.get()),i.searchParams.set("action",e);let n=t>0?t:this.logger.getTimeDelta();i.searchParams.set("duration",Math.round(n).toString()),fetch(i,{mode:"no-cors"})}sendPerformanceMetrics(){let e=this.window.performance.getEntriesByType("navigation");e.length>0&&(this.send("document_content_loaded",e[0].domContentLoadedEventEnd),this.send("document_load_time",e[0].loadEventEnd))}};sl=tT([ia(),tR(0,is(iq)),tR(1,is(iQ)),tR(2,is(im)),tR(3,ic(iW,iF,"MetricReporterService")),tA("design:paramtypes",["function"==typeof(eD=void 0!==iq&&iq)?eD:Object,"function"==typeof(ej=void 0!==iQ&&iQ)?ej:Object,"function"==typeof(eN="undefined"!=typeof Window&&Window)?eN:Object,"function"==typeof(ex=void 0!==iW&&iW)?ex:Object])],sl),function(e){e.LOCAL="local",e.IDENTITY_STORAGE="identity_storage"}(eV||(eV={})),(eM||(eM={})).IDENTITY="identity";let su=class{constructor(e,t,i,n){this.logger=e,this.uuid=t,this.storage=i,this.serviceBaseUrl=n,this.logGroup="identity-storage",this.IdentityStorageKey="identity",this.ISUrl=this.serviceBaseUrl.get()+"identity-storage/"}fetchData(){return tL(this,void 0,void 0,function*(){let e=new AbortController,t=setTimeout(()=>e.abort(),1e3);return fetch(this.ISUrl,{mode:"cors",credentials:"include",signal:e.signal}).then(e=>(clearTimeout(t),200===e.status||202===e.status)?e.json():this.createFallbackResponse()).catch(e=>(this.logger.info(this.logGroup,"Loading Identity LocalStorage data failed",e),this.createFallbackResponse()))})}postData(e){return tL(this,void 0,void 0,function*(){return fetch(this.ISUrl+"identity",{credentials:"include",mode:"cors",headers:{"Content-Type":"application/json"},method:"PUT",body:JSON.stringify({ppid:e.ppid})}).then(e=>e.json())})}getLocalData(){return this.storage.getItem(this.IdentityStorageKey)}setLocalData(e){this.storage.setItem(this.IdentityStorageKey,e)}createFallbackResponse(){return{timestamp:Date.now(),over18:!1,synced:!1,ppid:this.uuid()}}};su=tT([ia(),tR(0,ic(iW,iF,"UserIdentity")),tR(1,is(iy)),tR(2,is(iK)),tR(3,is(iq)),tA("design:paramtypes",["function"==typeof(eU=void 0!==iW&&iW)?eU:Object,Function,"function"==typeof(eG=void 0!==iK&&iK)?eG:Object,"function"==typeof(eF=void 0!==iq&&iq)?eF:Object])],su);let sd=class{constructor(e,t,i,n,o){this.storage=e,this.logger=t,this.windowContextRepository=i,this.instantConfigService=n,this.identityStorageClient=o}get(){return tL(this,void 0,void 0,function*(){let e=yield this.getLocalData();return(e&&!e.synced&&this.setRemote(e),!e||this.isDeprecated(e))?this.getRemote():(this.setIdentityContextVariables(e),e)})}setRemote(e){return tL(this,void 0,void 0,function*(){try{yield this.identityStorageClient.postData(e);let t=Object.assign(Object.assign({},this.identityStorageClient.getLocalData()),{synced:!0});return this.setIdentityContextVariables(t),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},t),{timestamp:Date.now()})),t}catch(e){this.logger.error("Updating Identity LocalStorage data failed")}})}isDeprecated(e){let t=this.instantConfigService.get("icIdentityTtl",6048e5),i=Date.now()-t;return!e.timestamp||e.timestamp-i<0}getLocalData(){return tL(this,void 0,void 0,function*(){let e=yield this.identityStorageClient.getLocalData();if(!e){let t=this.getLocalPPID()||this.getAdmsPPID();t&&(e=yield this.migrateDeprecatedIdentity(t))}return e})}migrateDeprecatedIdentity(e){return tL(this,void 0,void 0,function*(){let t=yield this.setRemote({ppid:e,synced:!1});return this.clearDeprecatedLocalPpid(),t})}getAdmsPPID(){var e,t;let i=this.storage.getItem("silver-surfer-active-data-v2");return null===(t=null===(e=null==i?void 0:i.IDENTITY)||void 0===e?void 0:e[0].payload)||void 0===t?void 0:t.identityToken}getLocalPPID(){return this.storage.getItem("ppid")}clearDeprecatedLocalPpid(){this.storage.removeItem("ppid")}getRemote(){return tL(this,void 0,void 0,function*(){let e=yield this.identityStorageClient.fetchData();return this.setIdentityContextVariables(e),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},e),{timestamp:Date.now()})),e})}setIdentityContextVariables(e){e.over18&&this.windowContextRepository.set("over_18",{value:"1"})}};sd=tT([ia(),tR(0,is(iK)),tR(1,ic(iW,iF,"UserIdentity")),tR(2,is(so)),tR(3,is(o9)),tR(4,is(su)),tA("design:paramtypes",["function"==typeof(eW=void 0!==iK&&iK)?eW:Object,"function"==typeof(eH=void 0!==iW&&iW)?eH:Object,"function"==typeof(eB=void 0!==so&&so)?eB:Object,"function"==typeof(e$=void 0!==o9&&o9)?e$:Object,"function"==typeof(eq=void 0!==su&&su)?eq:Object])],sd);let sh=class{constructor(e,t){this.logger=e,this.identityStorageService=t}get(){return tL(this,void 0,void 0,function*(){let e=yield this.identityStorageService.get();return this.logger.info(e),e.ppid})}};sh=tT([ia(),tR(0,ic(iW,iF,"UserIdentity")),tR(1,is(sd)),tA("design:paramtypes",["function"==typeof(ez=void 0!==iW&&iW)?ez:Object,"function"==typeof(eQ=void 0!==sd&&sd)?eQ:Object])],sh);let sp=class{constructor(e,t,i){this.logger=e,this.uuid=t,this.storage=i}get(){return Promise.resolve(this.storage.getItem("ppid")||this.generatePPID())}generatePPID(){this.logger.info("did not found a PPID in LocalStorage");let e=this.uuid();return this.storage.setItem("ppid",e),e}};sp=tT([ia(),tR(0,ic(iW,iF,"UserIdentity")),tR(1,is(iy)),tR(2,is(iK)),tA("design:paramtypes",["function"==typeof(eY=void 0!==iW&&iW)?eY:Object,Function,"function"==typeof(eK=void 0!==iK&&iK)?eK:Object])],sp);let sf=class{constructor(e,t,i,n,o,s,r){this.dataWarehouse=e,this.logger=t,this.windowContextRepository=i,this.instantConfigService=n,this.identityStorageRepository=o,this.localStorageRepository=s,this.communicationService=r}getPPID(e){switch(this.logger.info("active strategy: ",e),e){case eV.IDENTITY_STORAGE:return this.identityStorageRepository;case eV.LOCAL:default:return this.localStorageRepository}}generatePPID(){return tL(this,void 0,void 0,function*(){try{let e=this.instantConfigService.get("icPpidRepository",eV.LOCAL),t=yield this.getPPID(e).get();this.dataWarehouse.track(ea.identity,{partner_name:"Google",partner_identity_id:t}),this.communicationService.emit(new nK(oo.IDENTITY_PARTNER_DATA_OBTAINED,{payload:{partnerName:"Google",partnerIdentityId:t}})),this.windowContextRepository.set("ppid",{value:t}),this.logger.info("Passed PPID to page-level targeting")}catch(e){this.logger.error("Setting up PPID has failed!",e)}})}setPpid(){return tL(this,void 0,void 0,function*(){this.instantConfigService.get("icPpid",!1)?(this.logger.info("enabled - awaiting setup"),yield this.generatePPID()):this.logger.info("disabled")})}};sf=tT([ia(),tR(0,is(si)),tR(1,ic(iW,iF,"UserIdentity")),tR(2,is(so)),tR(3,is(o9)),tR(4,is(sh)),tR(5,is(sp)),tR(6,is(on)),tA("design:paramtypes",["function"==typeof(eJ=void 0!==si&&si)?eJ:Object,"function"==typeof(eX=void 0!==iW&&iW)?eX:Object,"function"==typeof(eZ=void 0!==so&&so)?eZ:Object,"function"==typeof(e0=void 0!==o9&&o9)?e0:Object,"function"==typeof(e1=void 0!==sh&&sh)?e1:Object,"function"==typeof(e2=void 0!==sp&&sp)?e2:Object,"function"==typeof(e6=void 0!==on&&on)?e6:Object])],sf);let sg=class{constructor(e,t,i,n,o,s,r){this.assetLoader=e,this.consentResolver=t,this.instantConfigService=i,this.coppaSubject=n,this.dataWarehouse=o,this.logger=s,this.metricReporter=r,this.partnerName="liveConnect",this.liveConnectScriptUrl="https://b-code.liadm.com/a-07ev.min.js",this.fallbackQf="0.3",this.live_connect_tracking_events={LIVE_CONNECT_STARTED:"live_connect_started",LIVE_CONNECT_CACHED:"live_connect_cached",LIVE_CONNECT_RESPONDED_UUID:"live_connect_responded_uuid"},this.idConfigMapping=[{id:"unifiedId",name:`${this.partnerName}-unifiedId`},{id:"sha2",name:this.partnerName,params:{qf:"0.3",resolve:"sha2"}},{id:"md5",name:`${this.partnerName}-md5`,params:{qf:"0.3",resolve:"md5"}},{id:"sha1",name:`${this.partnerName}-sha1`,params:{qf:"0.3",resolve:"sha1"}}]}isEnabled(){return this.consentResolver.getConsents()&&this.instantConfigService.get("icLiveConnect")&&this.instantConfigService.get("icLiveConnectCachingStrategy")&&this.instantConfigService.get("icIdentityPartners")&&!this.coppaSubject.isCoppaSubject()}init(){return tL(this,void 0,void 0,function*(){if(!this.isEnabled()){this.logger.info("disabled");return}this.setupStorage(),this.shouldLoadScript()?(this.logger.info("loading"),this.dataWarehouse.track(ea.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_STARTED),this.assetLoader.loadScript(this.liveConnectScriptUrl,"text/javascript",!1).then(()=>{this.logger.info("loaded"),this.resolveAndTrackIds(),this.logEvent("live-connect-requested")})):(this.dataWarehouse.track(ea.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_CACHED),this.logger.info(`already loaded and available in ${this.storageConfig.type}Storage`))})}resolveAndTrackIds(){var e;if(!window.liQ){this.logger.warn("window.liQ not available for tracking");return}let t=null===(e=this.instantConfigService.get("icLiveConnectQf"))||void 0===e?void 0:e.toString();window.liQ.resolve(e=>{this.trackIds(e)},e=>{console.error(e)},{qf:t||this.fallbackQf,resolve:this.idConfigMapping.map(e=>e.id)})}trackIds(e){this.logger.info("resolve response:",e),Object.keys(e).forEach(t=>{if(!e[t])return;let i=this.getTrackingKeyName(t);if(this.isAvailableInStorage(i))return;"unifiedId"===t&&this.dataWarehouse.track(ea.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_RESPONDED_UUID);let n=e[t];this.logger.info(`${t}: ${n}`),n&&(this.storage.setItem(i,n,this.storageConfig.ttl),this.dataWarehouse.track(ea.identity,{partner_name:i,partner_identity_id:n}))})}getTrackingKeyName(e){var t;return null===(t=this.idConfigMapping.find(t=>t.id===e))||void 0===t?void 0:t.name}setupStorage(){this.storageConfig=this.instantConfigService.get("icLiveConnectCachingStrategy"),"local"===this.storageConfig.type?this.storage=io.resolve(iK):this.storage=io.resolve(iJ)}shouldLoadScript(){var e;if(!this.storageConfig)return!0;let t=!1;for(let i of this.storageConfig.mandatoryParams){let n=null===(e=this.idConfigMapping.find(e=>e.id===i))||void 0===e?void 0:e.name;if(!this.isAvailableInStorage(n)){t=!0;break}}return t}isAvailableInStorage(e){return!!this.storage.getItem(e)}logEvent(e){this.metricReporter.send(e,1)}};sg=tT([ia(),tR(0,is(i0)),tR(1,is(t1(()=>i3))),tR(2,is(t1(()=>o9))),tR(3,is(sa)),tR(4,is(si)),tR(5,ic(iW,iF,"liveConnect")),tR(6,is(sl)),tA("design:paramtypes",["function"==typeof(e3=void 0!==i0&&i0)?e3:Object,"function"==typeof(e4=void 0!==i3&&i3)?e4:Object,"function"==typeof(e5=void 0!==o9&&o9)?e5:Object,"function"==typeof(e8=void 0!==sa&&sa)?e8:Object,"function"==typeof(e9=void 0!==si&&si)?e9:Object,"function"==typeof(e7=void 0!==iW&&iW)?e7:Object,"function"==typeof(te=void 0!==sl&&sl)?te:Object])],sg);let sv=class{constructor(e,t){this.logger=e,this.liveConnect=t}initializeTargetingPartners(){return tL(this,void 0,void 0,function*(){})}initializeTrackingPartners(){return tL(this,void 0,void 0,function*(){this.logger.info("Initializing partners"),yield Promise.all([this.liveConnect.init()])})}};sv=tT([ia(),tR(0,ic(iW,iF,"Partners")),tR(1,is(sg)),tA("design:paramtypes",["function"==typeof(tt=void 0!==iW&&iW)?tt:Object,"function"==typeof(ti=void 0!==sg&&sg)?ti:Object])],sv);let sm={C0001:"necessary",C0002:"performance",C0003:"functional",C0004:"targeting",C0005:"social"};class sy{constructor(e,t){this.container=e;let i=e.OptanonWrapper;e.OptanonWrapper=()=>{t.resolve(),null==i||i()}}available(){return void 0!==this.container.OneTrust}ready(){var e,t;let i=this.container.OneTrust;return void 0!==this.container.OnetrustActiveGroups&&((null===(t=null===(e=i.GetDomainData())||void 0===e?void 0:e.ConsentModel)||void 0===t?void 0:t.Name)!=="opt-in"||i.IsAlertBoxClosed())}resolve(){var e;return null===(e=this.container.OnetrustActiveGroups)||void 0===e?void 0:e.split(",").map(e=>sm[e]).filter(e=>e).reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:!0}),{})}}class sw{constructor(e,t){this.optIn=e,this.cookiesManager=t}available(){return void 0!==this.cookiesManager.get("OptanonConsent")}ready(){return!this.optIn||void 0!==this.cookiesManager.get("OptanonAlertBoxClosed")}resolve(){var e;let t=null===(e=decodeURIComponent(this.cookiesManager.get("OptanonConsent")))||void 0===e?void 0:e.match(/groups=([^&]+)/);return t&&t[1]?t[1].toUpperCase().split(",").map(e=>{let t=e.split(":");return"1"===t[1]?sm[t[0]]:void 0}).filter(e=>e).reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:!0}),{}):{}}}let sb={necessary:!0},sC={necessary:!0,performance:!0,functional:!0,targeting:!0,social:!0},sS=class{constructor(e,t,i){var n,o;this.container=e,this.logger=t,this.cookiesManager=i;let s=this.cookiesManager.get("Geo");this.queue=e.consentCallbackQueue,this.optIn=!!s&&iH.includes(null===(o=null===(n=JSON.parse(decodeURIComponent(s)))||void 0===n?void 0:n.country)||void 0===o?void 0:o.toLowerCase()),void 0!==this.queue&&this.init()}resolve(){return!!this.wasResolved()||(this.ifAvailableThenResolveIfReady(this.apiConsentResolver)?(this.logger.info("API available, resolved?:",this.categories),this.wasResolved()):!!this.ifAvailableThenResolveIfReady(this.cookieConsentResolver)&&(this.logger.info("Cookies available, resolved?:",this.categories),this.wasResolved()))}wasResolved(){return void 0!==this.categories}init(){this.logger.info("Setting up with opt-in status:",this.optIn),this.apiConsentResolver=new sy(this.container,this),this.cookieConsentResolver=new sw(this.optIn,this.cookiesManager),this.resolve()||setTimeout(()=>this.resolveWithFallback(),5e3)}resolveWithFallback(){this.resolve()||(this.apiConsentResolver.available()||this.cookieConsentResolver.available()?(this.logger.info("Still waiting for consent resolve with available api:",this.apiConsentResolver.available(),"or cookie:",this.cookieConsentResolver.available()),setTimeout(()=>this.resolveWithFallback,5e3)):(this.categories=this.fallback(),this.logger.info("Unable to resolve consent, fallback to:",this.categories),this.resolveQueue()))}ifAvailableThenResolveIfReady(e){let t=e.available();return t&&e.ready()&&(this.categories=e.resolve(),this.resolveQueue()),t}checkAndRun(e,t,i){return this.logger.info("About to callback:",e,"for:",i,"with:",this.categories),(void 0===i||!!this.categories[i])&&(t(this.categories),!0)}resolveQueue(){this.flushQueue(),this.queue.push=(e,t,i)=>this.checkAndRun(e,t,i),this.container.consentCallback=(e,t,i)=>this.checkAndRun(e,t,i)}flushQueue(){let e=this.queue.queue;this.logger.info("Consent resolved, flushing queue of size:",e.length);for(let t=e.length-1;t>=0;t--){let i=e[t];this.checkAndRun(i.name,i.callback,i.category)&&e.splice(t,1)}}fallback(){return this.optIn?sb:sC}};sS=tT([ia(),tR(0,is(im)),tR(1,ic(iW,iF,"ConsentCallbackQueueHandler")),tR(2,is(iv)),tA("design:paramtypes",["function"==typeof(tn="undefined"!=typeof Window&&Window)?tn:Object,"function"==typeof(to=void 0!==iW&&iW)?to:Object,"function"==typeof(ts="undefined"!=typeof CookiesManager&&CookiesManager)?ts:Object])],sS);let sI=class{constructor(e,t){this.window=e,this.logger=t,this.queue=[]}install(){this.logger.info("installing consent queue");let e=this;return this.window.consentCallbackQueue=this,this.window.consentCallback=(t,i,n)=>e.push(t,i,n),this}push(e,t,i){this.logger.warn("dialog not resolved, enqueued:",e),this.queue.push({name:e,callback:t,category:i})}};sI=tT([ia(),tR(0,is(im)),tR(1,ic(iW,iF,"ConsentCallbackQueue")),tA("design:paramtypes",["function"==typeof(tr="undefined"!=typeof Window&&Window)?tr:Object,"function"==typeof(ta=void 0!==iW&&iW)?ta:Object])],sI);let s_=class{constructor(e,t,i,n){this.sentry=e,this.browser=t,this.device=i,this.platform=n,this.sentry.setTags({browser:this.browser.getBrowser(),device:this.device.getDeviceType(),platform:this.platform.get()})}};s_=tT([ir(),tR(0,is(iw)),tR(1,is(iC)),tR(2,is(iU)),tR(3,is(iQ)),tA("design:paramtypes",[Object,"function"==typeof(tc=void 0!==iC&&iC)?tc:Object,"function"==typeof(tl=void 0!==iU&&iU)?tl:Object,"function"==typeof(tu=void 0!==iQ&&iQ)?tu:Object])],s_),io.register(iv,{useValue:function(e){return e&&e.__esModule?e.default:e}(il)}),io.register(iy,{useValue:function(e,t,i){if(id.randomUUID&&!t&&!e)return id.randomUUID();e=e||{};let n=e.random||(e.rng||ip)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){i=i||0;for(let e=0;e<16;++e)t[i+e]=n[e];return t}return function(e,t=0){return(ig[e[t+0]]+ig[e[t+1]]+ig[e[t+2]]+ig[e[t+3]]+"-"+ig[e[t+4]]+ig[e[t+5]]+"-"+ig[e[t+6]]+ig[e[t+7]]+"-"+ig[e[t+8]]+ig[e[t+9]]+"-"+ig[e[t+10]]+ig[e[t+11]]+ig[e[t+12]]+ig[e[t+13]]+ig[e[t+14]]+ig[e[t+15]]).toLowerCase()}(n)}}),io.register(im,{useValue:window});let sE=class{constructor(e,t,i,n,o,s,r,a,c,l,u,d,h,p,f,g){this.geoCookie=e,this.ageGateHandler=t,this.communicationService=i,this.optInService=n,this.hemTrackingService=o,this.trackingContextSetupService=s,this.consentResolver=r,this.instantConfigService=a,this.window=c,this.logger=l,this.ppidProvider=u,this.coppaSubject=p,this.metricReporterService=f,this.partnersService=g}initializeAgeGateHandler(){return tL(this,void 0,void 0,function*(){return this.ageGateHandler.init(this.communicationService)})}updateGTMConsent(e){void 0===this.window.dataLayer&&(this.window.dataLayer=[]),this.window.dataLayer.push({event:"user-consent",consent:e.toString()})}initializeTracking(){return tL(this,void 0,void 0,function*(){this.logger.info("Setting up tracking"),this.optInService.trackingAllowed=!0,this.hemTrackingService.activateTracking(),yield this.ppidProvider.setPpid(),yield this.partnersService.initializeTrackingPartners(),this.communicationService.emit(new nK(oo.IDENTITY_READY)),this.metricReporterService.send("ready")})}init(){return tL(this,void 0,void 0,function*(){yield this.geoCookie.setGeoCookieIfNotExist(),yield this.instantConfigService.init(),this.optInService.init(),this.metricReporterService.init(this.instantConfigService),this.metricReporterService.send("init")})}run(){this.logger.info("Starting identity engine v2.8.5");let e=this.window.location.hostname;this.communicationService.once(oo.CONSENT_READY,t=>{this.trackingContextSetupService.setup(e),this.consentResolver.resolve(t,()=>tL(this,void 0,void 0,function*(){this.updateGTMConsent(!0),this.partnersService.initializeTargetingPartners(),yield this.initializeAgeGateHandler(),this.coppaSubject.resolveCoppaStatus(),yield this.initializeTracking()}),()=>{this.updateGTMConsent(!1),this.partnersService.initializeTargetingPartners(),this.coppaSubject.resolveCoppaStatus(),this.optInService.trackingAllowed=!1,this.communicationService.emit(new nK(oo.IDENTITY_READY)),this.metricReporterService.send("ready"),this.logger.info("Tracking rejected")})})}};sE=tT([ia(),tR(0,is(iz)),tR(1,is(i1)),tR(2,is(on)),tR(3,is(o7)),tR(4,is(sc)),tR(5,is(sr)),tR(6,is(i3)),tR(7,is(o9)),tR(8,is(im)),tR(9,ic(iW,iF,"IdentityEngine")),tR(10,is(sf)),tR(11,is(sI)),tR(12,is(sS)),tR(13,is(sa)),tR(14,is(sl)),tR(15,is(sv)),tA("design:paramtypes",["function"==typeof(td=void 0!==iz&&iz)?td:Object,"function"==typeof(th=void 0!==i1&&i1)?th:Object,"function"==typeof(tp=void 0!==on&&on)?tp:Object,"function"==typeof(tf=void 0!==o7&&o7)?tf:Object,"function"==typeof(tg=void 0!==sc&&sc)?tg:Object,"function"==typeof(tv=void 0!==sr&&sr)?tv:Object,"function"==typeof(tm=void 0!==i3&&i3)?tm:Object,"function"==typeof(ty=void 0!==o9&&o9)?ty:Object,"function"==typeof(tw="undefined"!=typeof Window&&Window)?tw:Object,"function"==typeof(tb=void 0!==iW&&iW)?tb:Object,"function"==typeof(tC=void 0!==sf&&sf)?tC:Object,"function"==typeof(tS=void 0!==sI&&sI)?tS:Object,"function"==typeof(tI=void 0!==sS&&sS)?tI:Object,"function"==typeof(t_=void 0!==sa&&sa)?t_:Object,"function"==typeof(tE=void 0!==sl&&sl)?tE:Object,"function"==typeof(tO=void 0!==sv&&sv)?tO:Object])],sE),function(){tL(this,void 0,void 0,function*(){let e=function(){try{let e=io.resolve(iB).get();return"US"===e.country?.01:.1}catch(e){return .01}}(),t=new i6({dsn:"https://3e92e20316cf4539a579d82f4294be77@o4504176096247808.ingest.sentry.io/4505432026447872",release:"2.8.5",environment:"production",sampleRate:e});try{io.register(iw,{useValue:t}),io.resolve(s_);let e=io.resolve(sE);yield e.init(),e.run()}catch(e){t.captureException(e)}})}()})();
//# sourceMappingURL=index.js.map
